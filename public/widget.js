var ReqCheck=function(){"use strict";var e=(e,n,t)=>new Promise((o,i)=>{var r=e=>{try{l(t.next(e))}catch(n){i(n)}},s=e=>{try{l(t.throw(e))}catch(n){i(n)}},l=e=>e.done?o(e.value):Promise.resolve(e.value).then(r,s);l((t=t.apply(e,n)).next())});const n="undefined"!=typeof window?`${window.location.protocol}//${window.location.host}`:"";function t(t,o){return e(this,null,function*(){const e=window.location.origin;return(yield fetch(`${n}/api/v1/widget/validate?companyId=${encodeURIComponent(t)}&jobId=${encodeURIComponent(o)}&origin=${encodeURIComponent(e)}`)).json()})}function o(t,o,i){return e(this,null,function*(){const e=new URLSearchParams({companyId:t,jobId:o});i&&e.append("email",i);const r=yield fetch(`${n}/api/v1/widget/questions?${e.toString()}`);if(!r.ok)throw new Error(`Failed to get questions: ${r.statusText}`);return r.json()})}function i(t,o,i){return e(this,null,function*(){const e=yield fetch(`${n}/api/v1/widget/attempts/start`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({companyId:t,jobId:o,email:i})});if(!e.ok)throw new Error(`Failed to start attempt: ${e.statusText}`);return e.json()})}function r(t,o,i,r){return e(this,null,function*(){const e=yield fetch(`${n}/api/v1/widget/attempts/submit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionToken:t,attemptId:o,answers:i,timeTakenSeconds:r})});if(!e.ok)throw new Error(`Failed to submit attempt: ${e.statusText}`);return e.json()})}function s(t,o,i){return e(this,null,function*(){const e=new URLSearchParams({companyId:t,jobId:o,email:i}),r=yield fetch(`${n}/api/v1/widget/attempts/status?${e.toString()}`);if(!r.ok)throw new Error(`Failed to check status: ${r.statusText}`);return r.json()})}function l(t,o,i){return e(this,null,function*(){const e=new URLSearchParams({companyId:t,jobId:o,email:i}),r=yield fetch(`${n}/api/v1/widget/attempts/current?${e.toString()}`);if(!r.ok)throw new Error(`Failed to get current attempt: ${r.statusText}`);return r.json()})}const c="reqcheck_";function a(e,n,t){try{const o=`${c}email_${e}_${n}`;localStorage.setItem(o,JSON.stringify({email:t,timestamp:Date.now()}))}catch(o){}}function d(e,n,t){try{const o=`${c}status_${e}_${n}_${t.toLowerCase()}`,i=localStorage.getItem(o);return i?JSON.parse(i):null}catch(o){return null}}function u(e,n,t,o,i){try{const r=`${c}status_${e}_${n}_${t.toLowerCase()}`;localStorage.setItem(r,JSON.stringify({passed:o,score:i,timestamp:Date.now()}))}catch(r){}}function p(n,t,o){return e(this,null,function*(){if(!(n&&n.includes("@")&&o&&t))return{showCheckmark:!1,showCTA:!1,showWarning:!1};const e=n.toLowerCase().trim(),i=d(t,o,e);if(i){const e=Date.now()-i.timestamp,n=864e5;if(i.passed&&e<n)return{showCheckmark:!0,showCTA:!1,showWarning:!1};if(!i.passed&&e<n){const t=Math.ceil((n-e)/36e5);return{showCheckmark:!1,showCTA:!1,showWarning:!0,warningMessage:`Try again in ${t} hour${1!==t?"s":""}`}}}try{const n=yield s(t,o,e);if(u(t,o,e,n.passed,n.score),n.verified&&n.passed)return{showCheckmark:!0,showCTA:!1,showWarning:!1};if(n.verified&&!n.passed&&n.completedAt){const e=new Date(n.completedAt).getTime(),t=Date.now()-e,o=864e5;if(t<o){const e=Math.ceil((o-t)/36e5);return{showCheckmark:!1,showCTA:!1,showWarning:!0,warningMessage:`Try again in ${e} hour${1!==e?"s":""}`}}}return{showCheckmark:!1,showCTA:!0,showWarning:!1,ctaText:"Start Verification"}}catch(r){return{showCheckmark:!1,showCTA:!0,showWarning:!1,ctaText:"Start Verification"}}})}function m(e,n){const t=document.createElement("div");if(t.className="reqcheck-email-indicator",t.style.cssText="\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    margin-top: 0.5rem;\n    font-size: 0.875rem;\n  ",e.showCheckmark){const e=document.createElement("span");e.textContent="✓",e.style.cssText="\n      color: #10b981;\n      font-weight: bold;\n      font-size: 1.25rem;\n    ";const n=document.createElement("span");return n.textContent="Verified",n.style.cssText="color: #10b981;",t.appendChild(e),t.appendChild(n),t}if(e.showWarning){const n=document.createElement("span");n.textContent="⚠",n.style.cssText="\n      color: #f59e0b;\n      font-size: 1.25rem;\n    ";const o=document.createElement("span");return o.textContent=e.warningMessage||"Try again later",o.style.cssText="color: #f59e0b;",t.appendChild(n),t.appendChild(o),t}if(e.showCTA){const o=document.createElement("button");return o.textContent=e.ctaText||"Start Verification",o.type="button",o.style.cssText="\n      padding: 0.5rem 1rem;\n      background: #4f46e5;\n      color: white;\n      border: none;\n      border-radius: 4px;\n      cursor: pointer;\n      font-size: 0.875rem;\n      font-weight: 500;\n    ",o.onclick=e=>{e.preventDefault(),n()},t.appendChild(o),t}return null}function h(n,t,o,i){let r=null,s=null;const l=()=>e(this,null,function*(){const e=n.value.trim();if(r&&r.parentNode&&(r.parentNode.removeChild(r),r=null),!e||!e.includes("@"))return;const s=function(e,n){try{const t=`${c}email_${e}_${n}`,o=localStorage.getItem(t);return o?JSON.parse(o).email:null}catch(t){return null}}(t,o);if(s&&s.toLowerCase()!==e.toLowerCase()){const s=m(yield p(e,t,o),()=>i(e));if(s){const e=n.parentElement;e&&(e.appendChild(s),r=s)}}else if(s){const s=d(t,o,e.toLowerCase());if(s){const t=Date.now()-s.timestamp,o=864e5;if(s.passed&&t<o){const t=m({showCheckmark:!0,showCTA:!1,showWarning:!1},()=>i(e));if(t){const e=n.parentElement;e&&(e.appendChild(t),r=t)}}}}else{const s=m(yield p(e,t,o),()=>i(e));if(s){const e=n.parentElement;e&&(e.appendChild(s),r=s)}}a(t,o,e)});n.addEventListener("blur",()=>{s&&clearTimeout(s),s=window.setTimeout(l,300)}),n.value&&l()}function f(e){const n=e.querySelector(".reqcheck-overlay");n&&n.remove()}function g(e){const n=document.createElement("div");n.style.cssText="line-height: 1.6;";const t=/```(\w+)?\s*\n?([\s\S]*?)```/g,o=[];let i,r=0;for(t.lastIndex=0;null!==(i=t.exec(e));){if(i.index>r){const n=e.slice(r,i.index);n.trim()&&o.push({type:"text",content:n})}let n=i[2]||"";n=n.replace(/^\n+/,""),n=n.replace(/\n+$/,""),o.push({type:"code",content:n,language:i[1]||void 0}),r=i.index+i[0].length}if(r<e.length){const n=e.slice(r);n.trim()&&o.push({type:"text",content:n})}return 0===o.length&&o.push({type:"text",content:e}),o.forEach(e=>{if("code"===e.type){const t=document.createElement("div");t.style.cssText="\n        background: #f3f4f6;\n        border: 1px solid #e5e7eb;\n        border-radius: 6px;\n        padding: 1rem;\n        margin: 0.5rem 0;\n        overflow-x: auto;\n      ";const o=document.createElement("pre");o.style.cssText="\n        margin: 0;\n        font-family: monospace;\n        font-size: 0.875rem;\n        white-space: pre;\n        color: #1f2937;\n      ";const i=document.createElement("code");i.textContent=e.content,i.style.cssText="color: #1f2937;",o.appendChild(i),t.appendChild(o),n.appendChild(t)}else!function(e,n){const t=e.split("\n");let o=!1,i=null;for(const r of t){const e=r.match(/^[\s]*[-*]\s+(.+)$/),s=r.match(/^[\s]*\d+\.\s+(.+)$/);if(e||s){o||(o=!0,i=e?document.createElement("ul"):document.createElement("ol"),i.style.cssText="\n          margin: 0.5rem 0;\n          padding-left: 1.5rem;\n          color: #1f2937;\n        ",n.appendChild(i));const t=document.createElement("li");t.style.cssText="margin: 0.25rem 0; color: #1f2937;",y((null==e?void 0:e[1])||(null==s?void 0:s[1])||"",t),i.appendChild(t)}else if(o&&(o=!1,i=null),r.trim()){const e=document.createElement("p");e.style.cssText="margin: 0.5rem 0; color: #1f2937;",y(r,e),n.appendChild(e)}else if(t.length>1){const e=document.createElement("br");n.appendChild(e)}}}(e.content,n)}),n}function y(e,n){const t=[{regex:/`([^`]+)`/g,tag:"code"},{regex:/\*\*([^*]+)\*\*/g,tag:"strong"},{regex:/__([^_]+)__/g,tag:"strong"},{regex:/\*([^*]+)\*/g,tag:"em"},{regex:/_([^_]+)_/g,tag:"em"}];let o=0;const i=[];for(let r=0;r<t.length;r++){const n=t[r],o=new RegExp(n.regex.source,"g");let s;for(;null!==(s=o.exec(e));){if(!s[1])continue;i.some(e=>s.index>=e.index&&s.index<e.index+e.length||e.index>=s.index&&e.index<s.index+s[0].length)||i.push({index:s.index,length:s[0].length,tag:n.tag,content:s[1]})}}if(i.sort((e,n)=>e.index-n.index),i.length>0){for(const t of i){if(t.index>o){const i=e.slice(o,t.index);i&&n.appendChild(document.createTextNode(i))}const i=document.createElement(t.tag);"code"===t.tag?i.style.cssText="\n          background: #f3f4f6;\n          padding: 0.125rem 0.375rem;\n          border-radius: 4px;\n          font-family: monospace;\n          font-size: 0.875em;\n          color: #1f2937;\n        ":i.style.cssText="color: #1f2937;",i.textContent=t.content,n.appendChild(i),o=t.index+t.length}if(o<e.length){const t=e.slice(o);t&&n.appendChild(document.createTextNode(t))}}else n.appendChild(document.createTextNode(e))}function b(t,o,i,s,l,c=0,a=[],d,u){let p=c;const m=[...a],h=Date.now(),f=()=>e(this,null,function*(){if(p>=o.length)return void(yield y());const i=o[p],r=p+1,c=o.length;t.innerHTML="";const a=document.createElement("div");if(a.style.cssText="\n      padding: 2rem;\n    ",i.skillName){const e=document.createElement("div");e.style.cssText="\n        display: inline-block;\n        padding: 0.375rem 0.75rem;\n        background: #f3f4f6;\n        border-radius: 6px;\n        font-size: 0.875rem;\n        font-weight: 500;\n        color: #6b7280;\n        margin-bottom: 1rem;\n      ",e.textContent=i.skillName,a.appendChild(e)}const d=document.createElement("div");d.style.cssText="\n      margin-bottom: 1.5rem;\n    ";const u=document.createElement("div");u.style.cssText="\n      height: 4px;\n      background: #e5e7eb;\n      border-radius: 2px;\n      overflow: hidden;\n      margin-bottom: 0.5rem;\n    ";const h=document.createElement("div");h.style.cssText=`\n      height: 100%;\n      background: #000000;\n      width: ${(p+1)/c*100}%;\n      transition: width 0.3s;\n    `,u.appendChild(h);const b=document.createElement("div");b.textContent=`Question ${r} of ${c}`,b.style.cssText="\n      font-size: 0.875rem;\n      color: #6b7280;\n      text-align: center;\n    ",d.appendChild(u),d.appendChild(b);const x=document.createElement("div");x.style.cssText="\n      margin-bottom: 2rem;\n    ";const w=document.createElement("div");w.style.cssText="\n      margin: 0 0 1.5rem 0;\n      font-size: 1.25rem;\n      font-weight: 600;\n      color: #1f2937;\n    ";const C=g(i.prompt);if(w.appendChild(C),x.appendChild(w),"multiple_choice"===i.type){const e=i.config.options||[],n=m.find(e=>e.questionId===i.id),t=[];e.forEach(e=>{const o=document.createElement("label"),r=n&&n.answer===e;o.style.cssText=`\n          display: block;\n          padding: 1rem;\n          margin: 0.5rem 0;\n          border: 2px solid ${r?"#000000":"#e5e7eb"};\n          border-radius: 8px;\n          cursor: pointer;\n          transition: all 0.2s;\n          color: #1f2937;\n          background: ${r?"#f9fafb":"transparent"};\n        `;const s=document.createElement("input");s.type="radio",s.name=`question-${i.id}`,s.value=e,r&&(s.checked=!0),s.onchange=()=>{t.forEach(e=>{e.style.borderColor="#e5e7eb",e.style.background="transparent"}),o.style.borderColor="#000000",o.style.background="#f9fafb"},o.setAttribute("for",`question-${i.id}-${e}`),s.id=`question-${i.id}-${e}`,o.appendChild(s),o.appendChild(document.createTextNode(` ${e}`)),t.push(o),x.appendChild(o)})}else if("fill_blank_blocks"===i.type){const e=i.config,n=e.segments||[],t=e.shuffledOptions||[...e.correctAnswer||[],...e.extraBlanks||[]],o=m.find(e=>e.questionId===i.id);let r=[];o&&Array.isArray(o.answer)&&(r=[...o.answer]);const s=n.filter(e=>"blank"===e.type).length;for(;r.length<s;)r.push(null);r=r.slice(0,s);const l=document.createElement("div");l.style.cssText="\n        background: #f3f4f6;\n        border: 1px solid #e5e7eb;\n        border-radius: 8px;\n        padding: 1rem;\n        margin-bottom: 1.5rem;\n        overflow-x: auto;\n      ";const c=document.createElement("pre");c.style.cssText="\n        margin: 0;\n        font-family: monospace;\n        font-size: 0.875rem;\n        white-space: pre;\n        color: #1f2937;\n        line-height: 1.6;\n      ";const a=document.createElement("code");let d=0;n.forEach((e,n)=>{if("text"===e.type){const n=document.createElement("span");n.textContent=e.text,a.appendChild(n)}else if("blank"===e.type){const e=document.createElement("span"),n=d++,t=r[n];t?(e.style.cssText="\n              display: inline-block;\n              width: min-content;\n              min-width: 60px;\n              height: 24px;\n              margin: 0 4px;\n              padding: 2px 8px;\n              border: 2px solid #000000;\n              border-radius: 4px;\n              background: #ffffff;\n              cursor: pointer;\n              transition: all 0.2s;\n              vertical-align: middle;\n              line-height: 20px;\n              font-size: 0.875rem;\n              color: #1f2937;\n              white-space: nowrap;\n            ",e.textContent=t):(e.style.cssText="\n              display: inline-block;\n              width: 80px;\n              height: 24px;\n              margin: 0 4px;\n              padding: 2px 8px;\n              border: 2px dashed #9ca3af;\n              border-radius: 4px;\n              background: #f9fafb;\n              cursor: pointer;\n              transition: all 0.2s;\n              vertical-align: middle;\n              line-height: 20px;\n              font-size: 0.875rem;\n              color: #9ca3af;\n            ",e.textContent="____"),e.onclick=()=>{t&&(r[n]=null,h())},e.onmouseenter=()=>{t&&(e.style.background="#fee2e2",e.style.borderColor="#dc2626")},e.onmouseleave=()=>{t&&(e.style.background="#ffffff",e.style.borderColor="#000000")},a.appendChild(e)}else if("newline"===e.type)a.appendChild(document.createElement("br"));else if("tab"===e.type){const e=document.createElement("span");e.textContent="\t",a.appendChild(e)}}),c.appendChild(a),l.appendChild(c),x.appendChild(l);const u=document.createElement("p");u.textContent="Click an option to fill the earliest blank:",u.style.cssText="\n        margin: 0 0 0.75rem 0;\n        font-size: 0.875rem;\n        font-weight: 500;\n        color: #1f2937;\n      ",x.appendChild(u);const p=document.createElement("div");p.style.cssText="\n        display: flex;\n        flex-wrap: wrap;\n        gap: 0.5rem;\n        margin-bottom: 1rem;\n      ";const h=()=>{const e=new Map;r.forEach(n=>{null!==n&&e.set(n,(e.get(n)||0)+1)});const o=new Map;t.forEach(e=>{o.set(e,(o.get(e)||0)+1)});const i=t.filter(n=>(e.get(n)||0)<(o.get(n)||0));a.innerHTML="",d=0,n.forEach(e=>{if("text"===e.type){const n=document.createElement("span");n.textContent=e.text,a.appendChild(n)}else if("blank"===e.type){const e=document.createElement("span"),n=d++,t=r[n];t?(e.style.cssText="\n                display: inline-block;\n                width: min-content;\n                min-width: 60px;\n                height: 24px;\n                margin: 0 4px;\n                padding: 2px 8px;\n                border: 2px solid #000000;\n                border-radius: 4px;\n                background: #ffffff;\n                cursor: pointer;\n                transition: all 0.2s;\n                vertical-align: middle;\n                line-height: 20px;\n                font-size: 0.875rem;\n                color: #1f2937;\n                white-space: nowrap;\n              ",e.textContent=t):(e.style.cssText="\n                display: inline-block;\n                width: 80px;\n                height: 24px;\n                margin: 0 4px;\n                padding: 2px 8px;\n                border: 2px dashed #9ca3af;\n                border-radius: 4px;\n                background: #f9fafb;\n                cursor: pointer;\n                transition: all 0.2s;\n                vertical-align: middle;\n                line-height: 20px;\n                font-size: 0.875rem;\n                color: #9ca3af;\n              ",e.textContent="____"),e.onclick=()=>{t&&(r[n]=null,h())},e.onmouseenter=()=>{t&&(e.style.background="#fee2e2",e.style.borderColor="#dc2626")},e.onmouseleave=()=>{t&&(e.style.background="#ffffff",e.style.borderColor="#000000")},a.appendChild(e)}else if("newline"===e.type)a.appendChild(document.createElement("br"));else if("tab"===e.type){const e=document.createElement("span");e.textContent="\t",a.appendChild(e)}}),p.innerHTML="",i.forEach(e=>{const n=document.createElement("button");n.textContent=e,n.style.cssText="\n            padding: 0.5rem 0.75rem;\n            border: 1px solid #d1d5db;\n            border-radius: 6px;\n            background: white;\n            color: #1f2937;\n            font-size: 0.875rem;\n            font-weight: 500;\n            cursor: pointer;\n            transition: all 0.2s;\n          ",n.onmouseenter=()=>{n.style.background="#f3f4f6",n.style.borderColor="#000000"},n.onmouseleave=()=>{n.style.background="white",n.style.borderColor="#d1d5db"},n.onclick=()=>{const n=r.findIndex(e=>null===e);-1!==n&&(r[n]=e,h())},p.appendChild(n)})};h(),x.appendChild(p),x.getAnswer=()=>r.filter(e=>null!==e)}const k=document.createElement("button");k.type="button",k.textContent=p===o.length-1?"Submit Quiz":"Next Question",k.style.cssText="\n      width: 100%;\n      padding: 0.75rem;\n      background: #000000;\n      color: white;\n      border: none;\n      border-radius: 6px;\n      font-size: 1rem;\n      font-weight: 500;\n      cursor: pointer;\n      transition: background 0.2s;\n    ",k.onmouseenter=()=>{k.style.background="#1f2937"},k.onmouseleave=()=>{k.style.background="#000000"},k.onclick=()=>e(this,null,function*(){let t="";if("multiple_choice"===i.type){const e=document.querySelector(`input[name="question-${i.id}"]:checked`);t=(null==e?void 0:e.value)||""}else if("fill_blank_blocks"===i.type){const e=x.getAnswer;t=e?e():[]}if("fill_blank_blocks"===i.type){const e=(i.config.segments||[]).filter(e=>"blank"===e.type).length;if(!Array.isArray(t)||t.length<e)return void alert(`Please fill all ${e} blanks`)}else if(!t||Array.isArray(t)&&0===t.length)return void alert("Please provide an answer");const r=m.findIndex(e=>e.questionId===i.id);if(r>=0?m[r]={questionId:i.id,answer:t}:m.push({questionId:i.id,answer:t}),p===o.length-1)yield y();else try{yield function(t,o,i,r){return e(this,null,function*(){const e=yield fetch(`${n}/api/v1/widget/attempts/progress`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionToken:t,attemptId:o,questionId:i,answer:r})});if(!e.ok)throw new Error(`Failed to save progress: ${e.statusText}`);return e.json()})}(s,l,i.id,t),p++,yield f()}catch(c){alert(`Error saving progress: ${c.message}`)}}),a.appendChild(d),a.appendChild(x),a.appendChild(k),t.appendChild(a)}),y=()=>e(this,null,function*(){try{const e=o.map(e=>{const n=m.find(n=>n.questionId===e.id),t=(null==n?void 0:n.answer)||("fill_blank_blocks"===e.type?[]:"");return{questionId:e.id,answer:t}}),n=Math.floor((Date.now()-h)/1e3),c=yield r(s,l,e,n);!function(e,n,t,o,i){e.innerHTML="";const r=document.createElement("div");r.style.cssText="\n    padding: 3rem 2rem;\n    text-align: center;\n  ";const s=document.createElement("div");s.style.cssText="\n    font-size: 4rem;\n    margin-bottom: 1.5rem;\n  ",s.textContent=n?"✓":"✗",r.appendChild(s);const l=document.createElement("h2");l.style.cssText=`\n    font-size: 2rem;\n    font-weight: 700;\n    margin: 0 0 1rem 0;\n    color: ${n?"#059669":"#dc2626"};\n  `,l.textContent=n?"Verification Passed!":"Verification Failed",r.appendChild(l);const c=document.createElement("p");c.style.cssText="\n    font-size: 1.125rem;\n    color: #6b7280;\n    margin: 0 0 0.5rem 0;\n  ",c.textContent=`Score: ${t}%`,r.appendChild(c);const a=document.createElement("p");a.style.cssText="\n    font-size: 0.875rem;\n    color: #9ca3af;\n    margin: 0 0 2rem 0;\n  ",a.textContent=`Required: ${o}%`,r.appendChild(a);const d=document.createElement("button");d.textContent=n?"Continue":"Close",d.style.cssText=`\n    background: ${n?"#059669":"#dc2626"};\n    color: white;\n    border: none;\n    padding: 0.75rem 2rem;\n    font-size: 1rem;\n    font-weight: 600;\n    border-radius: 8px;\n    cursor: pointer;\n    transition: all 0.2s;\n  `,d.onmouseenter=()=>{d.style.opacity="0.9",d.style.transform="scale(1.02)"},d.onmouseleave=()=>{d.style.opacity="1",d.style.transform="scale(1)"},d.onclick=e=>{e.preventDefault(),e.stopPropagation(),i()},r.appendChild(d),e.appendChild(r)}(t,c.passed,c.score,i,()=>{d({passed:c.passed,score:c.score,verificationToken:c.verificationToken||void 0})})}catch(e){alert(`Error submitting quiz: ${e.message}`)}});f()}const x=new class{constructor(){this.config=null,this.callbacks={},this.initialized=!1,this.protectedElements=new Map}init(n){return e(this,arguments,function*(e,n={}){this.initialized||(this.config=e,this.callbacks=n,this.initialized=!0,!1!==e.autoInit&&this.autoInit())})}validateJob(n){return e(this,null,function*(){if(!this.config)return{canRender:!1};try{const e=yield t(this.config.companyId,n);return{canRender:!0===e.canRender,config:e.config}}catch(e){return{canRender:!1}}})}hideWidget(){this.protectedElements.forEach((e,n)=>{f(n),this.protectedElements.delete(n)})}autoInit(){return e(this,null,function*(){if(!this.config)return;this.attachEmailFields();const e=document.querySelectorAll("[data-reqcheck-mode]");for(const n of e){const e=n.getAttribute("data-reqcheck-mode"),t=n.getAttribute("data-reqcheck-job")||this.config.jobId;if(!t)continue;(yield this.validateJob(t)).canRender&&("protect"===e&&n instanceof HTMLFormElement?yield this.attachToForm(n,t):"gate"===e&&n instanceof HTMLElement&&this.attachToElement(n,t))}})}attachEmailFields(){if(!this.config)return;document.querySelectorAll("[data-reqcheck-email-field]").forEach(e=>{var n;const t=e.closest("form"),o=e.getAttribute("data-reqcheck-job")||(null==t?void 0:t.getAttribute("data-reqcheck-job"))||(null==(n=null==t?void 0:t.querySelector("[data-reqcheck-mode]"))?void 0:n.getAttribute("data-reqcheck-job"));o&&h(e,this.config.companyId,o,e=>{this.verify(e,o)})})}attachToForm(n,t){return e(this,null,function*(){var o;const i=yield this.validateJob(t);if(!i.canRender)return;null==(o=i.config)||o.passThreshold;const r=getComputedStyle(n);"static"===r.position&&(n.style.position="relative"),n.style.minHeight||"0px"!==r.minHeight||(n.style.minHeight="200px");const s=n.querySelector("[data-reqcheck-email-field]"),c=(null==s?void 0:s.value)||"";let a=!1;if(c)try{a="in_progress"===(yield l(this.config.companyId,t,c)).status}catch(u){}const d=function(e,n){const t=document.createElement("div");t.className="reqcheck-overlay",t.style.cssText="\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: rgba(0, 0, 0, 0.7);\n    backdrop-filter: blur(4px);\n    -webkit-backdrop-filter: blur(4px);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    z-index: 1000;\n    border-radius: inherit;\n  ";const o=document.createElement("div");o.style.cssText="\n    background: white;\n    padding: 2rem;\n    border-radius: 8px;\n    max-width: 400px;\n    width: 90%;\n    text-align: center;\n    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);\n  ";const i=document.createElement("h3");i.textContent="Verification Required",i.style.cssText="\n    margin: 0 0 1rem 0;\n    font-size: 1.5rem;\n    font-weight: 600;\n    color: #1f2937;\n  ";const r=document.createElement("p");r.textContent=n?"Continue your verification to unlock this form.":"Complete reqCHECK verification to unlock this form.",r.style.cssText="\n    margin: 0 0 1.5rem 0;\n    color: #6b7280;\n    font-size: 0.875rem;\n  ";const s=document.createElement("button");return s.textContent=n?"Continue Verification":"Start Verification",s.style.cssText="\n    padding: 0.75rem 1.5rem;\n    background: #000000;\n    color: white;\n    border: none;\n    border-radius: 6px;\n    font-size: 1rem;\n    font-weight: 500;\n    cursor: pointer;\n    transition: background 0.2s;\n  ",s.onmouseenter=()=>{s.style.background="#1f2937"},s.onmouseleave=()=>{s.style.background="#000000"},s.onclick=n=>{n.preventDefault(),n.stopPropagation(),e()},o.appendChild(i),o.appendChild(r),o.appendChild(s),t.appendChild(o),t}(()=>{this.showProtectModal(n,t)},a);n.appendChild(d),this.protectedElements.set(n,!0),n.addEventListener("submit",o=>e(this,null,function*(){o.preventDefault(),this.showProtectModal(n,t)}))})}showProtectModal(n,r){return e(this,null,function*(){if(!this.config)return;const s=n.querySelector("[data-reqcheck-email-field]"),c=(null==s?void 0:s.value)||"",d=function(e){const n=document.createElement("div");n.className="reqcheck-modal",n.style.cssText="\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: rgba(0, 0, 0, 0.8);\n    backdrop-filter: blur(8px);\n    -webkit-backdrop-filter: blur(8px);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    z-index: 10000;\n  ",n.onclick=e=>{e.target===n&&e.stopPropagation()};const t=document.createElement("div");t.style.cssText="\n    background: white;\n    border-radius: 12px;\n    max-width: 700px;\n    width: 90%;\n    max-height: 90vh;\n    overflow-y: auto;\n    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);\n    position: relative;\n  ",t.onclick=e=>{e.stopPropagation()};const o=document.createElement("button");return o.innerHTML="×",o.setAttribute("aria-label","Close"),o.style.cssText="\n    position: absolute;\n    top: 1rem;\n    right: 1rem;\n    background: transparent;\n    border: none;\n    font-size: 2rem;\n    color: #6b7280;\n    cursor: pointer;\n    width: 2.5rem;\n    height: 2.5rem;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 6px;\n    transition: all 0.2s;\n    z-index: 1;\n    line-height: 1;\n  ",o.onmouseenter=()=>{o.style.background="#f3f4f6",o.style.color="#1f2937"},o.onmouseleave=()=>{o.style.background="transparent",o.style.color="#6b7280"},o.onclick=n=>{n.preventDefault(),n.stopPropagation(),e(null)},t.appendChild(o),n.appendChild(t),n}(e=>{var t,o,i,s,l,p;document.body.removeChild(d),e&&(e.passed?(f(n),this.protectedElements.delete(n),u(this.config.companyId,r,c.toLowerCase(),!0,e.score),c&&a(this.config.companyId,r,c),null==(o=(t=this.callbacks).onSuccess)||o.call(t,e)):null==(s=(i=this.callbacks).onFailure)||s.call(i,e),null==(p=(l=this.callbacks).onComplete)||p.call(l,e))});document.body.appendChild(d);const p=d.querySelector("div");!function(e,n){e.innerHTML="";const t=document.createElement("div");t.style.cssText="\n    padding: 3rem 2rem;\n  ";const o=document.createElement("h2");o.textContent="Enter Your Email",o.style.cssText="\n    margin: 0 0 0.5rem 0;\n    font-size: 1.75rem;\n    font-weight: 600;\n    color: #1f2937;\n    text-align: center;\n  ";const i=document.createElement("p");i.textContent="We'll use this to track your verification progress.",i.style.cssText="\n    margin: 0 0 2rem 0;\n    color: #6b7280;\n    text-align: center;\n    font-size: 0.875rem;\n  ";const r=document.createElement("form");r.style.cssText="\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n  ",r.onsubmit=e=>{e.preventDefault();const t=s.value.trim();t&&t.includes("@")&&n(t)};const s=document.createElement("input");s.type="email",s.placeholder="candidate@example.com",s.required=!0,s.style.cssText="\n    padding: 0.75rem;\n    border: 1px solid #d1d5db;\n    border-radius: 6px;\n    font-size: 1rem;\n    outline: none;\n    transition: border-color 0.2s;\n    background: white;\n    color: #1f2937;\n  ",s.onfocus=()=>{s.style.borderColor="#000000"},s.onblur=()=>{s.style.borderColor="#d1d5db"};const l=document.createElement("button");l.type="submit",l.textContent="Continue",l.style.cssText="\n    padding: 0.75rem;\n    background: #000000;\n    color: white;\n    border: none;\n    border-radius: 6px;\n    font-size: 1rem;\n    font-weight: 500;\n    cursor: pointer;\n    transition: background 0.2s;\n  ",l.onmouseenter=()=>{l.style.background="#1f2937"},l.onmouseleave=()=>{l.style.background="#000000"},r.appendChild(s),r.appendChild(l),t.appendChild(o),t.appendChild(i),t.appendChild(r),e.appendChild(t)}(p,s=>e(this,null,function*(){var e,c,a,u,m,h;try{const g=yield l(this.config.companyId,r,s);if("passed"===g.status)return document.body.removeChild(d),f(n),this.protectedElements.delete(n),void(null==(a=(c=this.callbacks).onSuccess)||a.call(c,{passed:!0,score:(null==(e=g.attempt)?void 0:e.score)||0}));if("failed"===g.status||"abandoned"===g.status){p.innerHTML="";const e=document.createElement("div");e.style.cssText="padding: 3rem 2rem; text-align: center;";const n=document.createElement("h2");n.textContent="Verification Failed",n.style.cssText="\n            margin: 0 0 1rem 0;\n            font-size: 1.75rem;\n            font-weight: 600;\n            color: #dc2626;\n          ";const t=document.createElement("p"),o=g.timeRemaining;t.textContent=o?`You can try again in ${o} hour${1!==o?"s":""}.`:"You can try again in 24 hours.",t.style.cssText="\n            margin: 0 0 2rem 0;\n            color: #6b7280;\n            font-size: 1rem;\n          ";const i=document.createElement("button");return i.textContent="Close",i.style.cssText="\n            padding: 0.75rem 1.5rem;\n            background: #000000;\n            color: white;\n            border: none;\n            border-radius: 6px;\n            font-size: 1rem;\n            font-weight: 500;\n            cursor: pointer;\n          ",i.onclick=()=>{document.body.removeChild(d)},e.appendChild(n),e.appendChild(t),e.appendChild(i),void p.appendChild(e)}const y=(null==(u=(yield t(this.config.companyId,r)).config)?void 0:u.passThreshold)||70,x=yield i(this.config.companyId,r,s);let w=[],C=0,k=[];if(x.resumed&&"in_progress"===g.status)w=(null==(m=g.attempt)?void 0:m.questionsShown)||[],k=((null==(h=g.attempt)?void 0:h.answers)||[]).filter(e=>null!=e).map(e=>({questionId:e.questionId,answer:e.answer})),C=g.firstUnansweredIndex||0;else if(x.questions&&x.questions.length>0)w=x.questions;else{w=(yield o(this.config.companyId,r,s)).questions}if(0===w.length)return alert("No questions available"),void document.body.removeChild(d);b(p,w,y,x.sessionToken,x.attemptId,C,k,e=>{var t,o,i,r,s,l;document.body.removeChild(d),e.passed?(f(n),this.protectedElements.delete(n),null==(o=(t=this.callbacks).onSuccess)||o.call(t,e)):null==(r=(i=this.callbacks).onFailure)||r.call(i,e),null==(l=(s=this.callbacks).onComplete)||l.call(s,e)})}catch(g){alert(`Error: ${g.message||"Failed to start verification"}`),document.body.removeChild(d)}}))})}attachToElement(n,t){n instanceof HTMLAnchorElement?n.addEventListener("click",o=>e(this,null,function*(){o.preventDefault();const e=n.href;yield this.verify(null,t,e)})):n.addEventListener("click",()=>e(this,null,function*(){yield this.verify(null,t)}))}verify(n,t,r){return e(this,null,function*(){var e,l,c,d,p,m,h,f;if(!this.config)throw new Error("Widget not initialized");if(n||(n=prompt("Please enter your email address:")||""))try{const g=yield s(this.config.companyId,t,n);if(g.verified&&g.passed)return null==(l=(e=this.callbacks).onSuccess)||l.call(e,{passed:!0,score:g.score}),void(r&&(window.location.href=r));const y=yield o(this.config.companyId,t,n);if(!y.questions||0===y.questions.length)return void alert("No questions available for this job");const b=yield i(this.config.companyId,t,n),x=yield this.showQuizModal(y.questions,y.passThreshold,b.sessionToken,b.attemptId);this.config&&(u(this.config.companyId,t,n.toLowerCase(),x.passed,x.score),a(this.config.companyId,t,n)),x.passed?(null==(d=(c=this.callbacks).onSuccess)||d.call(c,x),r&&(window.location.href=r)):(null==(m=(p=this.callbacks).onFailure)||m.call(p,x),alert(`Verification failed. Score: ${x.score}% (Required: ${y.passThreshold}%)`)),null==(f=(h=this.callbacks).onComplete)||f.call(h,x)}catch(g){alert(`Error: ${g.message||"Failed to verify"}`)}})}showQuizModal(n,t,o,i){return e(this,null,function*(){return new Promise(e=>{const t=document.createElement("div");t.style.cssText="\n        position: fixed;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        background: rgba(0, 0, 0, 0.5);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        z-index: 10000;\n      ";const s=document.createElement("div");s.style.cssText="\n        background: white;\n        padding: 2rem;\n        border-radius: 8px;\n        max-width: 600px;\n        width: 90%;\n        max-height: 90vh;\n        overflow-y: auto;\n      ";let l=0;const c=[],a=Date.now(),d=()=>{s.innerHTML="";const u=n[l],p=l+1,m=n.length,h=document.createElement("div");h.innerHTML=`\n          <h2 style="margin: 0 0 1rem 0;">Question ${p} of ${m}</h2>\n          <p style="margin: 0 0 1.5rem 0;">${u.prompt}</p>\n        `,s.appendChild(h);const f=document.createElement("div");if(f.style.marginBottom="1.5rem","multiple_choice"===u.type){(u.config.options||[]).forEach(e=>{const n=document.createElement("label");n.style.cssText="\n              display: block;\n              padding: 0.75rem;\n              margin: 0.5rem 0;\n              border: 1px solid #ddd;\n              border-radius: 4px;\n              cursor: pointer;\n            ";const t=document.createElement("input");t.type="radio",t.name=`question-${u.id}`,t.value=e,n.appendChild(t),n.appendChild(document.createTextNode(` ${e}`)),f.appendChild(n)})}else if("fill_blank_blocks"===u.type){const e=document.createElement("textarea");e.placeholder="Enter your answer...",e.style.cssText="\n            width: 100%;\n            min-height: 100px;\n            padding: 0.5rem;\n            border: 1px solid #ddd;\n            border-radius: 4px;\n          ",f.appendChild(e)}s.appendChild(f);const g=document.createElement("div");if(g.style.cssText="\n          display: flex;\n          justify-content: space-between;\n          margin-top: 1.5rem;\n        ",l>0){const e=document.createElement("button");e.textContent="Previous",e.onclick=()=>{l--,d()},g.appendChild(e)}else g.appendChild(document.createElement("div"));const y=document.createElement("button");y.textContent=l===n.length-1?"Submit":"Next",y.onclick=()=>{let s="";if("multiple_choice"===u.type){const e=document.querySelector(`input[name="question-${u.id}"]:checked`);s=(null==e?void 0:e.value)||""}else if("fill_blank_blocks"===u.type){const e=f.querySelector("textarea");s=(null==e?void 0:e.value)||""}s?(c.push({questionId:u.id,question:u,answer:s}),l<n.length-1?(l++,d()):r(o,i,c,Math.floor((Date.now()-a)/1e3)).then(n=>{document.body.removeChild(t),e({passed:n.passed,score:n.score})}).catch(e=>{alert(`Error submitting: ${e.message}`)})):alert("Please provide an answer")},g.appendChild(y),s.appendChild(g)};d(),t.appendChild(s),document.body.appendChild(t)})})}initElement(n,t){return e(this,null,function*(){if(!this.config)throw new Error("Widget not initialized");const e=n.getAttribute("data-reqcheck-mode"),o=t||n.getAttribute("data-reqcheck-job")||this.config.jobId;o&&("protect"===e&&n instanceof HTMLFormElement?yield this.attachToForm(n,o):"gate"===e&&this.attachToElement(n,o))})}};if("undefined"!=typeof window){const e=document.currentScript;if(e){const n=e.getAttribute("data-reqcheck-company"),t="false"!==e.getAttribute("data-reqcheck-auto-init"),o="true"===e.getAttribute("data-reqcheck-test-mode");n&&x.init({companyId:n,jobId:"",autoInit:t,testMode:o},{})}}return window.ReqCheck={init:x.init.bind(x),verify:x.verify.bind(x),initElement:x.initElement.bind(x)},x}();
