var ReqCheck=function(){"use strict";const e="https://www.reqcheck.io";async function t(t,n,o){const i=window.location.origin,s=new URLSearchParams({companyId:t,jobId:n,origin:i});o&&s.append("testMode","true");const r=await fetch(`${e}/api/v1/widget/validate?${s.toString()}`);if(!r.ok)throw new Error(`Failed to validate widget: ${r.statusText}`);return r.json()}async function n(t,n,o){const i=new URLSearchParams({companyId:t,jobId:n});o&&i.append("email",o);const s=await fetch(`${e}/api/v1/widget/questions?${i.toString()}`);if(!s.ok)throw new Error(`Failed to get questions: ${s.statusText}`);return s.json()}async function o(t,n,o,i){const s=await fetch(`${e}/api/v1/widget/attempts/start`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({companyId:t,jobId:n,email:o,testMode:i||!1})});if(!s.ok)throw new Error(`Failed to start attempt: ${s.statusText}`);return s.json()}async function i(t,n,o,i){const s=await fetch(`${e}/api/v1/widget/attempts/submit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionToken:t,attemptId:n,answers:o,timeTakenSeconds:i})});if(!s.ok)throw new Error(`Failed to submit attempt: ${s.statusText}`);return s.json()}async function s(t,n,o){const i=new URLSearchParams({companyId:t,jobId:n,email:o}),s=await fetch(`${e}/api/v1/widget/attempts/current?${i.toString()}`);if(!s.ok)throw new Error(`Failed to get current attempt: ${s.statusText}`);return s.json()}async function r(t,n,o,i){const s=await fetch(`${e}/api/v1/widget/attempts/progress`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionToken:t,attemptId:n,questionId:o,answer:i})});if(!s.ok)throw new Error(`Failed to save progress: ${s.statusText}`)}const a="reqcheck_";function c(e,t){try{const n=`${a}email_${e}_${t}`,o=localStorage.getItem(n);return o?JSON.parse(o).email:null}catch{return null}}function l(e,t,n){try{const o=`${a}email_${e}_${t}`;localStorage.setItem(o,JSON.stringify({email:n,timestamp:Date.now()}))}catch{}}function d(e,t,n){try{const o=`${a}status_${e}_${t}_${n.toLowerCase()}`,i=localStorage.getItem(o);return i?JSON.parse(i):null}catch{return null}}function m(e,t,n,o,i){try{const s=`${a}status_${e}_${t}_${n.toLowerCase()}`;localStorage.setItem(s,JSON.stringify({passed:o,score:i,timestamp:Date.now()}))}catch{}}async function p(t,n,o){if(!(t&&t.includes("@")&&o&&n))return{showCheckmark:!1,showCTA:!1,showWarning:!1};const i=t.toLowerCase().trim(),s=d(n,o,i);if(s){const e=Date.now()-s.timestamp,t=864e5;if(s.passed&&e<t)return{showCheckmark:!0,showCTA:!1,showWarning:!1};if(!s.passed&&e<t){const n=Math.ceil((t-e)/36e5);return{showCheckmark:!1,showCTA:!1,showWarning:!0,warningMessage:`Try again in ${n} hour${1!==n?"s":""}`}}}try{const t=await async function(t,n,o){const i=new URLSearchParams({companyId:t,jobId:n,email:o}),s=await fetch(`${e}/api/v1/widget/attempts/status?${i.toString()}`);if(!s.ok)throw new Error(`Failed to check status: ${s.statusText}`);return s.json()}(n,o,i);if(m(n,o,i,t.passed,t.score),t.verified&&t.passed)return{showCheckmark:!0,showCTA:!1,showWarning:!1};if(t.verified&&!t.passed&&t.completedAt){const e=new Date(t.completedAt).getTime(),n=Date.now()-e,o=864e5;if(n<o){const e=Math.ceil((o-n)/36e5);return{showCheckmark:!1,showCTA:!1,showWarning:!0,warningMessage:`Try again in ${e} hour${1!==e?"s":""}`}}}return{showCheckmark:!1,showCTA:!0,showWarning:!1,ctaText:"Start Verification"}}catch(r){return{showCheckmark:!1,showCTA:!0,showWarning:!1,ctaText:"Start Verification"}}}function u(e,t){const n=document.createElement("div");if(n.className="reqcheck-email-indicator",n.style.cssText="\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    margin-top: 0.5rem;\n    font-size: 0.875rem;\n  ",e.showCheckmark){const e=document.createElement("span");e.textContent="✓",e.style.cssText="\n      color: #10b981;\n      font-weight: bold;\n      font-size: 1.25rem;\n    ";const t=document.createElement("span");return t.textContent="Verified",t.style.cssText="color: #10b981;",n.appendChild(e),n.appendChild(t),n}if(e.showWarning){const t=document.createElement("span");t.textContent="⚠",t.style.cssText="\n      color: #f59e0b;\n      font-size: 1.25rem;\n    ";const o=document.createElement("span");return o.textContent=e.warningMessage||"Try again later",o.style.cssText="color: #f59e0b;",n.appendChild(t),n.appendChild(o),n}if(e.showCTA){const o=document.createElement("button");return o.textContent=e.ctaText||"Start Verification",o.type="button",o.style.cssText="\n      padding: 0.5rem 1rem;\n      background: #4f46e5;\n      color: white;\n      border: none;\n      border-radius: 4px;\n      cursor: pointer;\n      font-size: 0.875rem;\n      font-weight: 500;\n    ",o.onclick=e=>{e.preventDefault(),t()},n.appendChild(o),n}return null}function h(e){const t=e.querySelector(".reqcheck-overlay");t&&t.remove()}function f(e,t,n,o,i,s){const r=e.querySelector(".reqcheck-overlay");if(!r)return;const a=(e,t)=>i?.[e]||t,c=r.querySelector("div");if(!c)return;c.innerHTML="";const l=document.createElement("div");l.style.cssText="\n    font-size: 3rem;\n    margin-bottom: 1rem;\n  ",l.textContent="✗",c.appendChild(l);const d=document.createElement("h3");d.textContent="Verification Failed",d.style.cssText="\n    margin: 0 0 0.75rem 0;\n    font-size: 1.5rem;\n    font-weight: 600;\n    color: #dc2626;\n  ",c.appendChild(d);const m=document.createElement("p");if(m.textContent=`Score: ${t}% (Required: ${n}%)`,m.style.cssText=`\n    margin: 0 0 0.5rem 0;\n    color: ${a("fontColor","#6b7280")};\n    opacity: 0.8;\n    font-size: 0.875rem;\n  `,c.appendChild(m),null!==o&&o>0){const e=document.createElement("p");e.textContent=`You can try again in ${o} hour${1!==o?"s":""}.`,e.style.cssText=`\n      margin: 0;\n      color: ${a("fontColor","#6b7280")};\n      opacity: 0.7;\n      font-size: 0.875rem;\n    `,c.appendChild(e)}else{const e=document.createElement("p");e.textContent="You can try again in 24 hours.",e.style.cssText=`\n      margin: 0;\n      color: ${a("fontColor","#6b7280")};\n      opacity: 0.7;\n      font-size: 0.875rem;\n    `,c.appendChild(e)}}function g(e){const t=document.createElement("div");t.style.cssText="line-height: 1.6;";const n=/```(\w+)?\s*\n?([\s\S]*?)```/g,o=[];let i,s=0;for(n.lastIndex=0;null!==(i=n.exec(e));){if(i.index>s){const t=e.slice(s,i.index);t.trim()&&o.push({type:"text",content:t})}let t=i[2]||"";t=t.replace(/^\n+/,""),t=t.replace(/\n+$/,""),o.push({type:"code",content:t,language:i[1]||void 0}),s=i.index+i[0].length}if(s<e.length){const t=e.slice(s);t.trim()&&o.push({type:"text",content:t})}return 0===o.length&&o.push({type:"text",content:e}),o.forEach(e=>{if("code"===e.type){const n=document.createElement("div");n.style.cssText="\n        background: #f3f4f6;\n        border: 1px solid #e5e7eb;\n        border-radius: 6px;\n        padding: 1rem;\n        margin: 0.5rem 0;\n        overflow-x: auto;\n      ";const o=document.createElement("pre");o.style.cssText="\n        margin: 0;\n        font-family: monospace;\n        font-size: 0.875rem;\n        white-space: pre;\n        color: #1f2937;\n      ";const i=document.createElement("code");i.textContent=e.content,i.style.cssText="color: #1f2937;",o.appendChild(i),n.appendChild(o),t.appendChild(n)}else!function(e,t){const n=e.split("\n");let o=!1,i=null;for(const s of n){const e=s.match(/^[\s]*[-*]\s+(.+)$/),r=s.match(/^[\s]*\d+\.\s+(.+)$/);if(e||r){o||(o=!0,i=e?document.createElement("ul"):document.createElement("ol"),i.style.cssText="\n          margin: 0.5rem 0;\n          padding-left: 1.5rem;\n          color: #1f2937;\n        ",t.appendChild(i));const n=document.createElement("li");n.style.cssText="margin: 0.25rem 0; color: #1f2937;",b(e?.[1]||r?.[1]||"",n),i.appendChild(n)}else if(o&&(o=!1,i=null),s.trim()){const e=document.createElement("p");e.style.cssText="margin: 0.5rem 0; color: #1f2937;",b(s,e),t.appendChild(e)}else if(n.length>1){const e=document.createElement("br");t.appendChild(e)}}}(e.content,t)}),t}function b(e,t){const n=[{regex:/`([^`]+)`/g,tag:"code"},{regex:/\*\*([^*]+)\*\*/g,tag:"strong"},{regex:/__([^_]+)__/g,tag:"strong"},{regex:/\*([^*]+)\*/g,tag:"em"},{regex:/_([^_]+)_/g,tag:"em"}];let o=0;const i=[];for(let s=0;s<n.length;s++){const t=n[s],o=new RegExp(t.regex.source,"g");let r;for(;null!==(r=o.exec(e));){if(!r[1])continue;i.some(e=>r.index>=e.index&&r.index<e.index+e.length||e.index>=r.index&&e.index<r.index+r[0].length)||i.push({index:r.index,length:r[0].length,tag:t.tag,content:r[1]})}}if(i.sort((e,t)=>e.index-t.index),i.length>0){for(const n of i){if(n.index>o){const i=e.slice(o,n.index);i&&t.appendChild(document.createTextNode(i))}const i=document.createElement(n.tag);"code"===n.tag?i.style.cssText="\n          background: #f3f4f6;\n          padding: 0.125rem 0.375rem;\n          border-radius: 4px;\n          font-family: monospace;\n          font-size: 0.875em;\n          color: #1f2937;\n        ":i.style.cssText="color: #1f2937;",i.textContent=n.content,t.appendChild(i),o=n.index+n.length}if(o<e.length){const n=e.slice(o);n&&t.appendChild(document.createTextNode(n))}}else t.appendChild(document.createTextNode(e))}function y(e,t,n){const o=(e,n)=>t?.[e]||n,i=document.createElement("div");i.className="reqcheck-modal",i.style.cssText="\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: rgba(0, 0, 0, 0.8);\n    backdrop-filter: blur(8px);\n    -webkit-backdrop-filter: blur(8px);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    z-index: 10000;\n  ",i.onclick=e=>{e.target===i&&e.stopPropagation()};const s=document.createElement("div");if(s.style.cssText=`\n    background: ${o("backgroundColor","white")};\n    border-radius: 12px;\n    max-width: 700px;\n    width: 90%;\n    max-height: 90vh;\n    display: flex;\n    flex-direction: column;\n    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);\n    position: relative;\n  `,s.onclick=e=>{e.stopPropagation()},n){const e=document.createElement("div");e.textContent="TEST MODE",e.style.cssText="\n      position: absolute;\n      top: -30px;\n      left: 50%;\n      transform: translateX(-50%);\n      background: #f59e0b;\n      color: white;\n      padding: 0.375rem 1.5rem;\n      border-top-left-radius: 8px;\n      border-top-right-radius: 8px;\n      font-size: 0.75rem;\n      font-weight: 600;\n      text-transform: uppercase;\n      letter-spacing: 0.05em;\n      z-index: 11;\n      box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.15);\n      white-space: nowrap;\n    ",s.appendChild(e)}const r=document.createElement("button");r.innerHTML="×",r.setAttribute("aria-label","Close");const a=o("fontColor","#6b7280");r.style.cssText=`\n    position: absolute;\n    top: 1rem;\n    right: 1rem;\n    background: transparent;\n    border: none;\n    font-size: 2rem;\n    color: ${a};\n    opacity: 0.7;\n    cursor: pointer;\n    width: 2.5rem;\n    height: 2.5rem;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 6px;\n    transition: all 0.2s;\n    z-index: 10;\n    line-height: 1;\n  `,r.onmouseenter=()=>{r.style.background="#f3f4f6",r.style.opacity="1"},r.onmouseleave=()=>{r.style.background="transparent",r.style.opacity="0.7"},r.onclick=t=>{t.preventDefault(),t.stopPropagation(),e(null)};const c=document.createElement("div");c.className="reqcheck-modal-content",c.style.cssText="\n    flex: 1;\n    overflow-y: auto;\n    position: relative;\n  ";const l=document.createElement("div");l.style.cssText="\n    padding: 1rem 2rem;\n    border-top: 1px solid #e5e7eb;\n    text-align: center;\n    background: #f9fafb;\n    border-bottom-left-radius: 12px;\n    border-bottom-right-radius: 12px;\n  ";const d=document.createElement("p");return d.textContent="Powered by reqCHECK",d.style.cssText=`\n    margin: 0;\n    font-size: 0.75rem;\n    color: ${o("fontColor","#9ca3af")};\n    opacity: 0.7;\n    font-weight: 500;\n  `,l.appendChild(d),s.appendChild(r),s.appendChild(c),s.appendChild(l),i.appendChild(s),i}function x(e,t,n){const o=(e,t)=>n?.[e]||t;e.innerHTML="";const i=document.createElement("div");i.style.cssText="\n    padding: 3rem 2rem;\n  ";const s=document.createElement("h2");s.textContent="Enter Your Email",s.style.cssText=`\n    margin: 0 0 0.5rem 0;\n    font-size: 1.75rem;\n    font-weight: 600;\n    color: ${o("fontColor","#1f2937")};\n    text-align: center;\n  `;const r=document.createElement("p");r.textContent="We'll use this to track your verification progress.",r.style.cssText=`\n    margin: 0 0 2rem 0;\n    color: ${o("fontColor","#6b7280")};\n    text-align: center;\n    font-size: 0.875rem;\n    opacity: 0.8;\n  `;const a=document.createElement("form");a.style.cssText="\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n  ",a.onsubmit=e=>{e.preventDefault();const n=c.value.trim();n&&n.includes("@")&&t(n)};const c=document.createElement("input");c.type="email",c.placeholder="candidate@example.com",c.required=!0;const l=o("buttonColor","#000000");c.style.cssText=`\n    padding: 0.75rem;\n    border: 1px solid #d1d5db;\n    border-radius: 6px;\n    font-size: 1rem;\n    outline: none;\n    transition: border-color 0.2s;\n    background: ${o("backgroundColor","white")};\n    color: ${o("fontColor","#1f2937")};\n  `,c.onfocus=()=>{c.style.borderColor=l},c.onblur=()=>{c.style.borderColor="#d1d5db"};const d=document.createElement("button");d.type="submit",d.textContent="Continue",d.style.cssText="\n    padding: 0.75rem;\n    background: #000000;\n    color: white;\n    border: none;\n    border-radius: 6px;\n    font-size: 1rem;\n    font-weight: 500;\n    cursor: pointer;\n    transition: background 0.2s;\n  ",d.onmouseenter=()=>{d.style.background="#1f2937"},d.onmouseleave=()=>{d.style.background="#000000"},a.appendChild(c),a.appendChild(d),i.appendChild(s),i.appendChild(r),i.appendChild(a),e.appendChild(i)}function w(e,t,n,o,s,a=0,c=[],l,d,m,p){const u=(e,t)=>m?.[e]||t;let h=a;const f=[...c],b=Date.now();let y=null;const x=async()=>{if(null!==y&&(clearInterval(y),y=null),h>=t.length)return void(await C());const n=t[h],i=h+1,a=t.length;e.innerHTML="";const c=document.createElement("div");if(c.style.cssText="\n      padding: 2rem;\n    ",n.skillName){const e=document.createElement("div");e.style.cssText=`\n        display: inline-block;\n        padding: 0.375rem 0.75rem;\n        background: #f3f4f6;\n        border-radius: 6px;\n        font-size: 0.875rem;\n        font-weight: 500;\n        color: ${u("fontColor","#6b7280")};\n        opacity: 0.8;\n        margin-bottom: 1rem;\n      `,e.textContent=n.skillName,c.appendChild(e)}const l=document.createElement("div");l.style.cssText="\n      margin-bottom: 1.5rem;\n    ";const d=document.createElement("div");d.style.cssText="\n      height: 4px;\n      background: #e5e7eb;\n      border-radius: 2px;\n      overflow: hidden;\n      margin-bottom: 0.5rem;\n    ";const m=document.createElement("div"),b=u("accentColor","#000000");m.style.cssText=`\n      height: 100%;\n      background: ${b};\n      width: ${(h+1)/a*100}%;\n      transition: width 0.3s;\n    `,d.appendChild(m);const w=document.createElement("div");w.style.cssText=`\n      font-size: 0.875rem;\n      color: ${u("fontColor","#6b7280")};\n      opacity: 0.8;\n      text-align: center;\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n    `;const v=document.createElement("span");v.textContent=`Question ${i} of ${a}`,w.appendChild(v);let k=null;if(n.timeLimitSeconds&&n.timeLimitSeconds>0){k=document.createElement("span"),k.style.cssText=`\n        font-weight: 600;\n        color: ${b};\n        font-size: 0.875rem;\n      `;let e=n.timeLimitSeconds;k.textContent=`${e}s`,y=window.setInterval(()=>{if(e--,k&&(k.textContent=`${e}s`,e<=10?k.style.color="#dc2626":e<=30&&(k.style.color="#f59e0b"),e<=0)){null!==y&&(clearInterval(y),y=null);const e=f.findIndex(e=>e.questionId===n.id),t="fill_blank_blocks"===n.type?[]:"";e>=0?f[e]={questionId:n.id,answer:t}:f.push({questionId:n.id,answer:t}),p||r(o,s,n.id,t).catch(e=>{}),h++,x()}},1e3),w.appendChild(k)}l.appendChild(d),l.appendChild(w);const E=document.createElement("div");E.style.cssText="\n      margin-bottom: 2rem;\n    ";const T=document.createElement("div");T.style.cssText=`\n      margin: 0 0 1.5rem 0;\n      font-size: 1.25rem;\n      font-weight: 600;\n      color: ${u("fontColor","#1f2937")};\n    `;const q=g(n.prompt);if(T.appendChild(q),E.appendChild(T),n.imageUrl){const e=document.createElement("div");e.style.cssText="\n        margin: 0 0 1.5rem 0;\n        width: 100%;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n      ";const t=document.createElement("img");t.src=n.imageUrl,t.alt=n.imageAltText||"Question image",t.style.cssText="\n        max-width: 100%;\n        height: 200px;\n        object-fit: contain;\n        border-radius: 8px;\n        border: 1px solid #e5e7eb;\n        background: #f9fafb;\n      ",e.appendChild(t),E.appendChild(e)}const $=document.createElement("button");$.type="button",$.textContent=h===t.length-1?"Submit Quiz":"Next Question";const S=u("buttonColor","#000000"),I=u("buttonTextColor","white"),M=()=>{let e=!1;if("multiple_choice"===n.type){e=!!document.querySelector(`input[name="question-${n.id}"]:checked`)}else if("fill_blank_blocks"===n.type){const t=(n.config.segments||[]).filter(e=>"blank"===e.type).length,o=E.getAnswer;if(o){const n=o();e=Array.isArray(n)&&n.length===t}}$.disabled=!e,$.style.cssText=e?`\n          width: 100%;\n          padding: 0.75rem;\n          background: ${S};\n          color: ${I};\n          border: none;\n          border-radius: 6px;\n          font-size: 1rem;\n          font-weight: 500;\n          cursor: pointer;\n          transition: background 0.2s;\n        `:"\n          width: 100%;\n          padding: 0.75rem;\n          background: #d1d5db;\n          color: #9ca3af;\n          border: none;\n          border-radius: 6px;\n          font-size: 1rem;\n          font-weight: 500;\n          cursor: not-allowed;\n          transition: background 0.2s;\n          opacity: 0.6;\n        "};if("multiple_choice"===n.type){const e=n.config.options||[],t=f.find(e=>e.questionId===n.id),o=[],i=u("accentColor","#000000");e.forEach(e=>{const s=document.createElement("label"),r=t&&t.answer===e;s.style.cssText=`\n          display: block;\n          padding: 1rem;\n          margin: 0.5rem 0;\n          border: 2px solid ${r?i:"#e5e7eb"};\n          border-radius: 8px;\n          cursor: pointer;\n          transition: all 0.2s;\n          color: ${u("fontColor","#1f2937")};\n          background: ${r?"#f9fafb":"transparent"};\n        `;const a=document.createElement("input");a.type="radio",a.name=`question-${n.id}`,a.value=e,r&&(a.checked=!0),a.onchange=()=>{o.forEach(e=>{e.style.borderColor="#e5e7eb",e.style.background="transparent"}),s.style.borderColor=i,s.style.background="#f9fafb",M()},s.setAttribute("for",`question-${n.id}-${e}`),a.id=`question-${n.id}-${e}`,s.appendChild(a),s.appendChild(document.createTextNode(` ${e}`)),o.push(s),E.appendChild(s)})}else if("fill_blank_blocks"===n.type){const e=n.config,t=e.segments||[],o=e.shuffledOptions||[...e.correctAnswer||[],...e.extraBlanks||[]],i=f.find(e=>e.questionId===n.id);let s=[];i&&Array.isArray(i.answer)&&(s=[...i.answer]);const r=t.filter(e=>"blank"===e.type).length;for(;s.length<r;)s.push(null);s=s.slice(0,r);const a=document.createElement("div");a.style.cssText="\n        background: #f3f4f6;\n        border: 1px solid #e5e7eb;\n        border-radius: 8px;\n        padding: 1rem;\n        margin-bottom: 1.5rem;\n        overflow-x: auto;\n      ";const c=document.createElement("pre");c.style.cssText="\n        margin: 0;\n        font-family: monospace;\n        font-size: 0.875rem;\n        white-space: pre;\n        color: #1f2937;\n        line-height: 1.6;\n      ";const l=document.createElement("code");let d=0;t.forEach((e,t)=>{if("text"===e.type){const t=document.createElement("span");t.textContent=e.text,l.appendChild(t)}else if("blank"===e.type){const e=document.createElement("span"),t=d++,n=s[t];n?(e.style.cssText="\n              display: inline-block;\n              width: min-content;\n              min-width: 60px;\n              height: 24px;\n              margin: 0 4px;\n              padding: 2px 8px;\n              border: 2px solid #000000;\n              border-radius: 4px;\n              background: #ffffff;\n              cursor: pointer;\n              transition: all 0.2s;\n              vertical-align: middle;\n              line-height: 20px;\n              font-size: 0.875rem;\n              color: #1f2937;\n              white-space: nowrap;\n            ",e.textContent=n):(e.style.cssText="\n              display: inline-block;\n              width: 80px;\n              height: 24px;\n              margin: 0 4px;\n              padding: 2px 8px;\n              border: 2px dashed #9ca3af;\n              border-radius: 4px;\n              background: #f9fafb;\n              cursor: pointer;\n              transition: all 0.2s;\n              vertical-align: middle;\n              line-height: 20px;\n              font-size: 0.875rem;\n              color: #9ca3af;\n            ",e.textContent="____"),e.onclick=()=>{n&&(s[t]=null,h())},e.onmouseenter=()=>{n&&(e.style.background="#fee2e2",e.style.borderColor="#dc2626")},e.onmouseleave=()=>{n&&(e.style.background="#ffffff",e.style.borderColor="#000000")},l.appendChild(e)}else if("newline"===e.type)l.appendChild(document.createElement("br"));else if("tab"===e.type){const e=document.createElement("span");e.textContent="\t",l.appendChild(e)}}),c.appendChild(l),a.appendChild(c),E.appendChild(a);const m=document.createElement("p");m.textContent="Click an option to fill the earliest blank:",m.style.cssText="\n        margin: 0 0 0.75rem 0;\n        font-size: 0.875rem;\n        font-weight: 500;\n        color: #1f2937;\n      ",E.appendChild(m);const p=document.createElement("div");p.style.cssText="\n        display: flex;\n        flex-wrap: wrap;\n        gap: 0.5rem;\n        margin-bottom: 1rem;\n      ";const h=()=>{const e=new Map;s.forEach(t=>{null!==t&&e.set(t,(e.get(t)||0)+1)});const n=new Map;o.forEach(e=>{n.set(e,(n.get(e)||0)+1)});const i=o.filter(t=>(e.get(t)||0)<(n.get(t)||0));M(),l.innerHTML="",d=0,t.forEach(e=>{if("text"===e.type){const t=document.createElement("span");t.textContent=e.text,l.appendChild(t)}else if("blank"===e.type){const e=document.createElement("span"),t=d++,n=s[t];if(n){const t=u("accentColor","#000000");e.style.cssText=`\n                display: inline-block;\n                width: min-content;\n                min-width: 60px;\n                height: 24px;\n                margin: 0 4px;\n                padding: 2px 8px;\n                border: 2px solid ${t};\n                border-radius: 4px;\n                background: #ffffff;\n                cursor: pointer;\n                transition: all 0.2s;\n                vertical-align: middle;\n                line-height: 20px;\n                font-size: 0.875rem;\n                color: ${u("fontColor","#1f2937")};\n                white-space: nowrap;\n              `,e.textContent=n}else e.style.cssText="\n                display: inline-block;\n                width: 80px;\n                height: 24px;\n                margin: 0 4px;\n                padding: 2px 8px;\n                border: 2px dashed #9ca3af;\n                border-radius: 4px;\n                background: #f9fafb;\n                cursor: pointer;\n                transition: all 0.2s;\n                vertical-align: middle;\n                line-height: 20px;\n                font-size: 0.875rem;\n                color: #9ca3af;\n              ",e.textContent="____";e.onclick=()=>{n&&(s[t]=null,h())},e.onmouseenter=()=>{n&&(e.style.background="#fee2e2",e.style.borderColor="#dc2626")},e.onmouseleave=()=>{if(n){const t=u("accentColor","#000000");e.style.background="#ffffff",e.style.borderColor=t}},l.appendChild(e)}else if("newline"===e.type)l.appendChild(document.createElement("br"));else if("tab"===e.type){const e=document.createElement("span");e.textContent="\t",l.appendChild(e)}}),p.innerHTML="",i.forEach(e=>{const t=document.createElement("button");t.textContent=e,t.style.cssText="\n            padding: 0.5rem 0.75rem;\n            border: 1px solid #d1d5db;\n            border-radius: 6px;\n            background: white;\n            color: #1f2937;\n            font-size: 0.875rem;\n            font-weight: 500;\n            cursor: pointer;\n            transition: all 0.2s;\n          ",t.onmouseenter=()=>{const e=u("accentColor","#000000");t.style.background="#f3f4f6",t.style.borderColor=e},t.onmouseleave=()=>{t.style.background="white",t.style.borderColor="#d1d5db"},t.onclick=()=>{const t=s.findIndex(e=>null===e);-1!==t&&(s[t]=e,h())},p.appendChild(t)})};h(),E.appendChild(p),E.getAnswer=()=>s.filter(e=>null!==e)}M(),$.onmouseenter=()=>{$.disabled||($.style.background="#000000"===S?"#1f2937":S)},$.onmouseleave=()=>{$.disabled||($.style.background=S)},$.onclick=async()=>{if($.disabled)return;let e="";if("multiple_choice"===n.type){const t=document.querySelector(`input[name="question-${n.id}"]:checked`);e=t?.value||""}else if("fill_blank_blocks"===n.type){const t=E.getAnswer;e=t?t():[]}if("fill_blank_blocks"===n.type){const t=(n.config.segments||[]).filter(e=>"blank"===e.type).length;if(!Array.isArray(e)||e.length<t)return void alert(`Please fill all ${t} blanks`)}else if(!e||Array.isArray(e)&&0===e.length)return void alert("Please provide an answer");null!==y&&(clearInterval(y),y=null);const t=f.findIndex(e=>e.questionId===n.id);if(t>=0?f[t]={questionId:n.id,answer:e}:f.push({questionId:n.id,answer:e}),!p)try{await r(o,s,n.id,e)}catch(i){}h++,x()},c.appendChild(l),c.appendChild(E),c.appendChild($),e.appendChild(c)},w=(e,t)=>{if("multiple_choice"===e.type){if("string"!=typeof t)return!1;const n=e.config,o=n?.correctAnswer;return!!o&&o.trim().toLowerCase()===t.trim().toLowerCase()}if("fill_blank_blocks"===e.type){if(!Array.isArray(t))return!1;const n=e.config,o=n?.correctAnswer;if(!Array.isArray(o))return!1;if(t.length!==o.length)return!1;for(let e=0;e<t.length;e++){const n=o[e]?.trim().toLowerCase(),i=t[e]?.trim().toLowerCase();if(n!==i)return!1}return!0}return!1},C=async()=>{null!==y&&(clearInterval(y),y=null);try{const r=t.map(e=>{const t=f.find(t=>t.questionId===e.id),n=t?.answer||("fill_blank_blocks"===e.type?[]:"");return{questionId:e.id,answer:n}});let a;if(p){let e=0;for(const n of r){const o=t.find(e=>e.id===n.questionId);o&&w(o,n.answer)&&e++}const o=t.length,i=o>0?Math.round(e/o*100):0;a={passed:i>=n,score:i,verificationToken:null}}else{const e=Math.floor((Date.now()-b)/1e3),t=await i(o,s,r,e);a={passed:t.passed,score:t.score,verificationToken:t.verificationToken||null}}!function(e,t,n,o,i,s){const r=(e,t)=>s?.[e]||t;e.innerHTML="";const a=document.createElement("div");a.style.cssText="\n    padding: 3rem 2rem;\n    text-align: center;\n  ";const c=document.createElement("div");c.style.cssText="\n    font-size: 4rem;\n    margin-bottom: 1.5rem;\n  ",c.textContent=t?"✓":"✗",a.appendChild(c);const l=r("accentColor","#000000"),d=t?l:"#dc2626",m="#dc2626",p=document.createElement("h2");p.style.cssText=`\n    font-size: 2rem;\n    font-weight: 700;\n    margin: 0 0 1rem 0;\n    color: ${t?d:m};\n  `,p.textContent=t?"Verification Passed!":"Verification Failed",a.appendChild(p);const u=document.createElement("p");u.style.cssText=`\n    font-size: 1.125rem;\n    color: ${r("fontColor","#6b7280")};\n    opacity: 0.8;\n    margin: 0 0 0.5rem 0;\n  `,u.textContent=`Score: ${n}%`,a.appendChild(u);const h=document.createElement("p");h.style.cssText=`\n    font-size: 0.875rem;\n    color: ${r("fontColor","#9ca3af")};\n    opacity: 0.7;\n    margin: 0 0 2rem 0;\n  `,h.textContent=`Required: ${o}%`,a.appendChild(h);const f=document.createElement("button");f.textContent=t?"Continue":"Close";const g=r("buttonColor","#000000"),b=r("buttonTextColor","white");f.style.cssText=`\n    background: ${t?"#000000"!==g?g:d:m};\n    color: ${b};\n    border: none;\n    padding: 0.75rem 2rem;\n    font-size: 1rem;\n    font-weight: 600;\n    border-radius: 8px;\n    cursor: pointer;\n    transition: all 0.2s;\n  `,f.onmouseenter=()=>{f.style.opacity="0.9",f.style.transform="scale(1.02)"},f.onmouseleave=()=>{f.style.opacity="1",f.style.transform="scale(1)"},f.onclick=e=>{e.preventDefault(),e.stopPropagation(),i()},a.appendChild(f),e.appendChild(a)}(e,a.passed,a.score,n,()=>{l({passed:a.passed,score:a.score,verificationToken:a.verificationToken||void 0})},m)}catch(r){alert(`Error submitting quiz: ${r.message}`)}};x()}const C=new class{constructor(){this.config=null,this.callbacks={},this.initialized=!1,this.protectedElements=new Map,this.protectSubmitHandlers=new Map,this.gateElements=new Map,this.widgetStyles=null,this.mutationObserver=null,this.processedElements=new WeakMap,this.rescanTimer=null,this.lastBodyContent=""}getStyle(e,t){return this.widgetStyles?.[e]||t}async init(e,t={}){if(this.initialized)return this.config=e,this.callbacks=t,void(!1===e.autoInit||this.mutationObserver||(this.startMutationObserver(),this.autoInit()));this.config=e,this.callbacks=t,this.initialized=!0,!1!==e.autoInit&&this.autoInit()}async validateJob(e){if(!this.config)return{canRender:!1};try{const n=await t(this.config.companyId,e,this.config.testMode);return n.widgetStyles&&(this.widgetStyles=n.widgetStyles),{canRender:!0===n.canRender,config:n.config}}catch(n){return{canRender:!1}}}hideWidget(){this.protectedElements.forEach((e,t)=>{h(t),this.protectedElements.delete(t)}),this.protectSubmitHandlers.forEach((e,t)=>{t.removeEventListener("submit",e),this.protectSubmitHandlers.delete(t)}),this.gateElements.forEach((e,t)=>{t.removeEventListener("click",e),this.gateElements.delete(t)})}async processElement(e){if(!this.config)return;const t=e.getAttribute("data-reqcheck-mode");if(!t)return;const n=e.getAttribute("data-reqcheck-job")||this.config.jobId;if(!n)return;const o=`${t}:${n}`,i=this.processedElements.get(e);if(i!==o)if(i&&i!==o&&this.cleanupElement(e),this.processedElements.set(e,o),"protect"===t&&e instanceof HTMLFormElement){if(!(await this.validateJob(n)).canRender)return;await this.attachToForm(e,n)}else if("gate"===t&&e instanceof HTMLElement){if(!(await this.validateJob(n)).canRender)return;await this.attachToElement(e,n)}else"inline"===t&&e instanceof HTMLElement&&await this.attachToInlineElement(e,n)}async autoInit(){if(!this.config)return;"loading"===document.readyState&&await new Promise(e=>{"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>e()):e()}),this.attachEmailFields();const e=document.querySelectorAll("[data-reqcheck-mode]");for(const t of e)await this.processElement(t);this.startMutationObserver()}async rescan(){if(!this.config)return;this.attachEmailFields();const e=document.querySelectorAll("[data-reqcheck-mode]");for(const t of e)await this.processElement(t)}scheduleRescan(){this.rescanTimer&&clearTimeout(this.rescanTimer),this.rescanTimer=window.setTimeout(()=>{this.rescan().catch(e=>{})},100)}cleanupElement(e){if(this.protectedElements.has(e)&&(h(e),this.protectedElements.delete(e)),e instanceof HTMLFormElement){const t=this.protectSubmitHandlers.get(e);t&&(e.removeEventListener("submit",t),this.protectSubmitHandlers.delete(e))}const t=this.gateElements.get(e);t&&(e.removeEventListener("click",t),this.gateElements.delete(e))}startMutationObserver(){if(!this.config)return;this.mutationObserver&&this.mutationObserver.disconnect(),this.lastBodyContent=document.body?.innerHTML?.substring(0,1e3)||"",this.mutationObserver=new MutationObserver(e=>{let t=!1;for(const o of e){for(const e of o.addedNodes)if(e.nodeType===Node.ELEMENT_NODE){const n=e;o.addedNodes.length>5&&(t=!0),n.hasAttribute("data-reqcheck-email-field")&&this.attachEmailFields(),n.hasAttribute("data-reqcheck-mode")&&this.processElement(n).catch(e=>{});const i=n.querySelectorAll("[data-reqcheck-mode]");for(const e of i)this.processElement(e).catch(e=>{});n.querySelectorAll("[data-reqcheck-email-field]").length>0&&this.attachEmailFields()}if("attributes"===o.type&&o.target instanceof HTMLElement){const e=o.target;"data-reqcheck-mode"===o.attributeName||"data-reqcheck-job"===o.attributeName?e.hasAttribute("data-reqcheck-mode")?this.processElement(e).catch(e=>{}):(this.cleanupElement(e),this.processedElements.delete(e)):"data-reqcheck-email-field"===o.attributeName&&e.hasAttribute("data-reqcheck-email-field")&&this.attachEmailFields()}}t&&this.scheduleRescan();const n=document.body?.innerHTML?.substring(0,1e3)||"";n!==this.lastBodyContent&&(this.lastBodyContent=n,this.scheduleRescan())});const e=document.body||document.documentElement;this.mutationObserver.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["data-reqcheck-mode","data-reqcheck-job","data-reqcheck-email-field"]});const t=setInterval(()=>{if(!this.config||!this.mutationObserver)return void clearInterval(t);const e=document.body?.innerHTML?.substring(0,1e3)||"";e!==this.lastBodyContent&&(this.lastBodyContent=e,this.scheduleRescan())},500)}stopMutationObserver(){this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=null),this.rescanTimer&&(clearTimeout(this.rescanTimer),this.rescanTimer=null)}attachEmailFields(){if(!this.config)return;document.querySelectorAll("[data-reqcheck-email-field]").forEach(e=>{const t=e.closest("form"),n=e.getAttribute("data-reqcheck-job")||t?.getAttribute("data-reqcheck-job")||t?.querySelector("[data-reqcheck-mode]")?.getAttribute("data-reqcheck-job");n&&function(e,t,n,o){let i=null,s=null;const r=async()=>{const s=e.value.trim();if(i&&i.parentNode&&(i.parentNode.removeChild(i),i=null),!s||!s.includes("@"))return;const r=c(t,n);if(r&&r.toLowerCase()!==s.toLowerCase()){const r=u(await p(s,t,n),()=>o(s));if(r){const t=e.parentElement;t&&(t.appendChild(r),i=r)}}else if(r){const r=d(t,n,s.toLowerCase());if(r){const t=Date.now()-r.timestamp,n=864e5;if(r.passed&&t<n){const t=u({showCheckmark:!0,showCTA:!1,showWarning:!1},()=>o(s));if(t){const n=e.parentElement;n&&(n.appendChild(t),i=t)}}}}else{const r=u(await p(s,t,n),()=>o(s));if(r){const t=e.parentElement;t&&(t.appendChild(r),i=r)}}l(t,n,s)};e.addEventListener("blur",()=>{s&&clearTimeout(s),s=window.setTimeout(r,300)}),e.value&&r()}(e,this.config.companyId,n,t=>{const o=e.closest("form");o&&o.hasAttribute("data-reqcheck-mode")&&this.showProtectModal(o,n)})})}async attachToForm(e,t){const n=await this.validateJob(t);if(!n.canRender)return;n.config,h(e);const o=getComputedStyle(e);"static"===o.position&&(e.style.position="relative"),e.style.minHeight||"0px"!==o.minHeight||(e.style.minHeight="200px");const i=e.querySelector("[data-reqcheck-email-field]"),r=i?.value||"";let a=!1;if(r)try{a="in_progress"===(await s(this.config.companyId,t,r)).status}catch{}const c=function(e,t,n,o){const i=(e,t)=>n?.[e]||t,s=document.createElement("div");s.className="reqcheck-overlay",s.style.cssText="\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: rgba(0, 0, 0, 0.7);\n    backdrop-filter: blur(4px);\n    -webkit-backdrop-filter: blur(4px);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    z-index: 50;\n    border-radius: inherit;\n  ";const r=document.createElement("div");if(r.style.cssText="\n    background: white;\n    padding: 2rem;\n    border-radius: 8px;\n    max-width: 400px;\n    width: 90%;\n    text-align: center;\n    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);\n    position: relative;\n  ",o){const e=document.createElement("div");e.textContent="TEST MODE",e.style.cssText="\n      position: absolute;\n      top: -30px;\n      left: 50%;\n      transform: translateX(-50%);\n      background: #f59e0b;\n      color: white;\n      padding: 0.375rem 1.5rem;\n      border-top-left-radius: 8px;\n      border-top-right-radius: 8px;\n      font-size: 0.75rem;\n      font-weight: 600;\n      text-transform: uppercase;\n      letter-spacing: 0.05em;\n      z-index: 51;\n      box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.15);\n      white-space: nowrap;\n    ",r.appendChild(e)}const a=document.createElement("h3");a.textContent="Verification Required",a.style.cssText=`\n    margin: 0 0 1rem 0;\n    font-size: 1.5rem;\n    font-weight: 600;\n    color: ${i("fontColor","#1f2937")};\n  `;const c=document.createElement("p");c.textContent=t?"Continue your verification to unlock this form.":"Complete reqCHECK verification to unlock this form.",c.style.cssText=`\n    margin: 0 0 1.5rem 0;\n    color: ${i("fontColor","#6b7280")};\n    opacity: 0.8;\n    font-size: 0.875rem;\n  `;const l=document.createElement("button");l.textContent=t?"Continue Verification":"Start Verification";const d=i("buttonColor","#000000"),m=i("buttonTextColor","white");return l.style.cssText=`\n    padding: 0.75rem 1.5rem;\n    background: ${d};\n    color: ${m};\n    border: none;\n    border-radius: 6px;\n    font-size: 1rem;\n    font-weight: 500;\n    cursor: pointer;\n    transition: background 0.2s;\n  `,l.onmouseenter=()=>{l.style.background="#000000"===d?"#1f2937":d},l.onmouseleave=()=>{l.style.background=d},l.onclick=t=>{t.preventDefault(),t.stopPropagation(),e()},r.appendChild(a),r.appendChild(c),r.appendChild(l),s.appendChild(r),s}(()=>{this.showProtectModal(e,t)},a,this.widgetStyles||void 0,this.config?.testMode);e.appendChild(c),this.protectedElements.set(e,!0);const l=this.protectSubmitHandlers.get(e);l&&(e.removeEventListener("submit",l),this.protectSubmitHandlers.delete(e));const d=async n=>{n.preventDefault(),this.showProtectModal(e,t)};e.addEventListener("submit",d),this.protectSubmitHandlers.set(e,d)}async showProtectModal(e,i,r){if(!this.config)return;const a=e.querySelector("[data-reqcheck-email-field]"),c=a?.value||"",d=y(t=>{document.body.removeChild(d),t&&(t.passed?(h(e),this.protectedElements.delete(e),m(this.config.companyId,i,c.toLowerCase(),!0,t.score),c&&l(this.config.companyId,i,c),this.callbacks.onSuccess?.(t)):this.callbacks.onFailure?.(t),this.callbacks.onComplete?.(t))},this.widgetStyles||void 0,this.config?.testMode);document.body.appendChild(d);const p=d.querySelector(".reqcheck-modal-content");x(p,async a=>{try{const l=await s(this.config.companyId,i,a);if("passed"===l.status)return document.body.removeChild(d),h(e),this.protectedElements.delete(e),void this.callbacks.onSuccess?.({passed:!0,score:l.attempt?.score||0});const m=await t(this.config.companyId,i,this.config?.testMode),u=m.config?.passThreshold||70;if("failed"===l.status||"abandoned"===l.status){const t=l.attempt?.score||0;f(e,t,u,l.timeRemaining,this.widgetStyles||void 0,this.config),p.innerHTML="";const n=document.createElement("div");n.style.cssText="padding: 3rem 2rem; text-align: center;";const o=document.createElement("h2");o.textContent="Verification Failed",o.style.cssText="\n            margin: 0 0 1rem 0;\n            font-size: 1.75rem;\n            font-weight: 600;\n            color: #dc2626;\n          ";const i=document.createElement("p"),s=l.timeRemaining;i.textContent=s?`You can try again in ${s} hour${1!==s?"s":""}.`:"You can try again in 24 hours.",i.style.cssText="\n            margin: 0 0 2rem 0;\n            color: #6b7280;\n            font-size: 1rem;\n          ";const r=document.createElement("button");return r.textContent="Close",r.style.cssText="\n            padding: 0.75rem 1.5rem;\n            background: #000000;\n            color: white;\n            border: none;\n            border-radius: 6px;\n            font-size: 1rem;\n            font-weight: 500;\n            cursor: pointer;\n          ",r.onclick=()=>{document.body.removeChild(d)},n.appendChild(o),n.appendChild(i),n.appendChild(r),void p.appendChild(n)}const g=void 0!==r?r:this.config?.testMode,b=await o(this.config.companyId,i,a,g);let y=[],x=0,C=[];if(b.resumed&&"in_progress"===l.status){const e=l.attempt?.questionsShown;if(Array.isArray(e)&&e.length>0)y=e,C=(l.attempt?.answers||[]).filter(e=>null!=e).map(e=>({questionId:e.questionId,answer:e.answer})),x=l.firstUnansweredIndex||0;else if(b.questions&&b.questions.length>0)y=b.questions;else{y=(await n(this.config.companyId,i,a)).questions}}else if(b.questions&&b.questions.length>0)y=b.questions;else{y=(await n(this.config.companyId,i,a)).questions}if(!Array.isArray(y)||0===y.length)return alert("No questions available"),void document.body.removeChild(d);w(p,y,u,b.sessionToken,b.attemptId,x,C,async t=>{if(document.body.removeChild(d),t.passed)h(e),this.protectedElements.delete(e),this.callbacks.onSuccess?.(t);else{let n=null;if(c)try{n=(await s(this.config.companyId,i,c)).timeRemaining}catch{}f(e,t.score,u,n,this.widgetStyles||void 0,this.config),this.callbacks.onFailure?.(t)}this.callbacks.onComplete?.(t)},0,this.widgetStyles||void 0,this.config?.testMode)}catch(l){alert(`Error: ${l.message||"Failed to start verification"}`),document.body.removeChild(d)}},this.widgetStyles||void 0)}async attachToInlineElement(e,t){if(!this.config)return void(e.innerHTML='\n        <div style="padding: 2rem; text-align: center; color: #6b7280;">\n          <p>Verification is currently unavailable.</p>\n        </div>\n      ');if(!t)return void(e.innerHTML='\n        <div style="padding: 2rem; text-align: center; color: #6b7280;">\n          <p>Verification is currently unavailable.</p>\n        </div>\n      ');if(!(await this.validateJob(t)).canRender)return void(e.innerHTML='\n        <div style="padding: 2rem; text-align: center; color: #6b7280;">\n          <p>Verification is currently unavailable.</p>\n        </div>\n      ');const n=c(this.config.companyId,t);let o=!1;if(n)try{o="in_progress"===(await s(this.config.companyId,t,n)).status}catch{}this.renderInlineWidget(e,t,o),e.__reqcheckJobId=t}renderInlineWidget(e,t,n=!1){e.innerHTML="";const o=this.getStyle("buttonColor","#000000"),i=this.getStyle("buttonTextColor","white");if(e.style.cssText=`\n      padding: 2rem;\n      background: ${this.getStyle("backgroundColor","white")};\n      border: 2px solid #e5e7eb;\n      border-radius: 8px;\n      text-align: center;\n      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);\n      position: relative;\n    `,this.config?.testMode){const t=document.createElement("div");t.textContent="TEST MODE",t.style.cssText="\n        position: absolute;\n        top: -30px;\n        left: 50%;\n        transform: translateX(-50%);\n        background: #f59e0b;\n        color: white;\n        padding: 0.375rem 1.5rem;\n        border-top-left-radius: 8px;\n        border-top-right-radius: 8px;\n        font-size: 0.75rem;\n        font-weight: 600;\n        text-transform: uppercase;\n        letter-spacing: 0.05em;\n        z-index: 1;\n        box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.15);\n        white-space: nowrap;\n      ",e.appendChild(t)}const s=document.createElement("h3");s.textContent="Verification Required",s.style.cssText=`\n      margin: 0 0 1rem 0;\n      font-size: 1.5rem;\n      font-weight: 600;\n      color: ${this.getStyle("fontColor","#1f2937")};\n    `;const r=document.createElement("p");r.textContent=n?"Required: Continue your verification to be considered for this position.":"Required: Complete reqCHECK verification to be considered for this position.",r.style.cssText=`\n      margin: 0 0 1.5rem 0;\n      color: ${this.getStyle("fontColor","#6b7280")};\n      opacity: 0.8;\n      font-size: 0.875rem;\n    `;const a=document.createElement("button");a.textContent=n?"Continue Verification":"Start Verification",a.style.cssText=`\n      padding: 0.75rem 1.5rem;\n      background: ${o};\n      color: ${i};\n      border: none;\n      border-radius: 6px;\n      font-size: 1rem;\n      font-weight: 500;\n      cursor: pointer;\n      transition: background 0.2s;\n    `,a.onmouseenter=()=>{a.style.background="#000000"===o?"#1f2937":o},a.onmouseleave=()=>{a.style.background=o},a.onclick=n=>{n.preventDefault(),n.stopPropagation(),this.showInlineModal(e,t)},e.appendChild(s),e.appendChild(r),e.appendChild(a)}updateInlineWidgetWithResult(e,t,n){e.innerHTML="";const o=this.getStyle("accentColor","#000000"),i=t?o:"#dc2626",s="#dc2626",r=t?"#f0fdf4":"#fef2f2",a=t?"#86efac":"#fca5a5";if(e.style.cssText=`\n      padding: 2rem;\n      background: ${t?r:"#fef2f2"};\n      border: 2px solid ${t?a:"#fca5a5"};\n      border-radius: 8px;\n      text-align: center;\n      position: relative;\n    `,this.config?.testMode){const t=document.createElement("div");t.textContent="TEST MODE",t.style.cssText="\n        position: absolute;\n        top: -30px;\n        left: 50%;\n        transform: translateX(-50%);\n        background: #f59e0b;\n        color: white;\n        padding: 0.375rem 1.5rem;\n        border-top-left-radius: 8px;\n        border-top-right-radius: 8px;\n        font-size: 0.75rem;\n        font-weight: 600;\n        text-transform: uppercase;\n        letter-spacing: 0.05em;\n        z-index: 1;\n        box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.15);\n        white-space: nowrap;\n      ",e.appendChild(t)}const c=document.createElement("div");c.textContent=t?"✓":"✗",c.style.cssText=`\n      font-size: 3rem;\n      margin-bottom: 1rem;\n      color: ${t?i:s};\n    `;const l=document.createElement("h3");l.textContent=t?"Verification Passed!":"Verification Failed",l.style.cssText=`\n      margin: 0 0 0.5rem 0;\n      font-size: 1.5rem;\n      font-weight: 600;\n      color: ${t?i:s};\n    `;const d=document.createElement("p");d.textContent=`Score: ${n}%`,d.style.cssText=`\n      margin: 0 0 1rem 0;\n      color: ${this.getStyle("fontColor","#6b7280")};\n      opacity: 0.8;\n      font-size: 0.875rem;\n    `;const m=document.createElement("p");m.textContent=t?"You have successfully completed verification.":"You can try again in 24 hours.",m.style.cssText=`\n      margin: 0;\n      color: ${this.getStyle("fontColor","#6b7280")};\n      opacity: 0.8;\n      font-size: 0.875rem;\n    `,e.appendChild(c),e.appendChild(l),t||e.appendChild(d),e.appendChild(m)}async showInlineModal(e,i){if(!this.config)return;let r="",a=null;const c=t=>{document.body.removeChild(d),t&&(t.passed?(r&&m(this.config.companyId,i,r.toLowerCase(),!0,t.score),this.updateInlineWidgetWithResult(e,!0,t.score),this.callbacks.onSuccess?.(t)):(r&&m(this.config.companyId,i,r.toLowerCase(),!1,t.score),this.updateInlineWidgetWithResult(e,!1,t.score),this.callbacks.onFailure?.(t)),this.callbacks.onComplete?.(t))},d=y(c,this.widgetStyles||void 0,this.config?.testMode);a=c,document.body.appendChild(d);const p=d.querySelector(".reqcheck-modal-content");x(p,async c=>{r=c,l(this.config.companyId,i,c);try{const r=await s(this.config.companyId,i,c);if("passed"===r.status)return document.body.removeChild(d),m(this.config.companyId,i,c.toLowerCase(),!0,r.attempt?.score||0),this.updateInlineWidgetWithResult(e,!0,r.attempt?.score||0),void this.callbacks.onSuccess?.({passed:!0,score:r.attempt?.score||0});if("failed"===r.status||"abandoned"===r.status){p.innerHTML="";const t=document.createElement("div");t.style.cssText="padding: 3rem 2rem; text-align: center;";const n=document.createElement("h2");n.textContent="Verification Failed",n.style.cssText="\n            margin: 0 0 1rem 0;\n            font-size: 1.75rem;\n            font-weight: 600;\n            color: #dc2626;\n          ";const o=document.createElement("p"),i=r.timeRemaining;o.textContent=i?`You can try again in ${i} hour${1!==i?"s":""}.`:"You can try again in 24 hours.",o.style.cssText="\n            margin: 0 0 2rem 0;\n            color: #6b7280;\n            font-size: 1rem;\n          ";const s=document.createElement("button");return s.textContent="Close",s.style.cssText="\n            padding: 0.75rem 1.5rem;\n            background: #000000;\n            color: white;\n            border: none;\n            border-radius: 6px;\n            font-size: 1rem;\n            font-weight: 500;\n            cursor: pointer;\n          ",s.onclick=()=>{document.body.removeChild(d),this.updateInlineWidgetWithResult(e,!1,r.attempt?.score||0)},t.appendChild(n),t.appendChild(o),t.appendChild(s),p.appendChild(t),void this.callbacks.onFailure?.({passed:!1,score:r.attempt?.score||0})}const l=await t(this.config.companyId,i,this.config?.testMode),u=l.config?.passThreshold||70,h=void 0!==testModeOverride?testModeOverride:this.config?.testMode,f=await o(this.config.companyId,i,c,h);let g=[],b=0,y=[];if(f.resumed&&"in_progress"===r.status){const e=r.attempt?.questionsShown;if(Array.isArray(e)&&e.length>0)g=e,y=(r.attempt?.answers||[]).filter(e=>null!=e).map(e=>({questionId:e.questionId,answer:e.answer})),b=r.firstUnansweredIndex||0;else if(f.questions&&f.questions.length>0)g=f.questions;else{g=(await n(this.config.companyId,i,c)).questions}}else if(f.questions&&f.questions.length>0)g=f.questions;else{g=(await n(this.config.companyId,i,c)).questions}if(!Array.isArray(g)||0===g.length)return alert("No questions available"),void document.body.removeChild(d);w(p,g,u,f.sessionToken,f.attemptId,b,y,e=>{a&&a(e)},0,this.widgetStyles||void 0,this.config?.testMode)}catch(u){alert(`Error: ${u.message||"Failed to start verification"}`),document.body.removeChild(d)}},this.widgetStyles||void 0)}async attachToElement(e,t){if(!(await this.validateJob(t)).canRender){const t=this.gateElements.get(e);return void(t&&(e.removeEventListener("click",t),this.gateElements.delete(e)))}const n=this.gateElements.get(e);let o;n&&(e.removeEventListener("click",n),this.gateElements.delete(e)),o=e instanceof HTMLAnchorElement?e.href:e.getAttribute("data-reqcheck-redirect")||void 0;const i=async e=>{e.preventDefault(),e.stopPropagation(),await this.showGateModal(t,o)};e.addEventListener("click",i),this.gateElements.set(e,i)}async verify(e,t,n,o){if(!this.config)throw new Error("Widget not initialized");const i=void 0!==o?o:this.config.testMode;if(e&&n)return void(await this.showGateModal(t,n,i));const s=document.querySelectorAll(`form[data-reqcheck-mode="protect"][data-reqcheck-job="${t}"]`);s.length>0&&await this.showProtectModal(s[0],t,i)}async showGateModal(e,i,r){if(!this.config)return;let a="",c=null;const d=t=>{document.body.removeChild(p),t&&(t.passed?(a&&m(this.config.companyId,e,a.toLowerCase(),!0,t.score),this.callbacks.onSuccess?.(t),i&&(window.location.href=i)):(a&&m(this.config.companyId,e,a.toLowerCase(),!1,t.score),this.callbacks.onFailure?.(t)),this.callbacks.onComplete?.(t))},p=y(d,this.widgetStyles||void 0,this.config?.testMode);c=d,document.body.appendChild(p);const u=p.querySelector(".reqcheck-modal-content");x(u,async d=>{a=d,l(this.config.companyId,e,d);try{const a=await s(this.config.companyId,e,d);if("passed"===a.status)return document.body.removeChild(p),m(this.config.companyId,e,d.toLowerCase(),!0,a.attempt?.score||0),this.callbacks.onSuccess?.({passed:!0,score:a.attempt?.score||0}),void(i&&(window.location.href=i));if("failed"===a.status||"abandoned"===a.status){u.innerHTML="";const e=document.createElement("div");e.style.cssText="padding: 3rem 2rem; text-align: center;";const t=document.createElement("h2");t.textContent="Verification Failed",t.style.cssText="\n            margin: 0 0 1rem 0;\n            font-size: 1.75rem;\n            font-weight: 600;\n            color: #dc2626;\n          ";const n=document.createElement("p"),o=a.timeRemaining;n.textContent=o?`You can try again in ${o} hour${1!==o?"s":""}.`:"You can try again in 24 hours.",n.style.cssText="\n            margin: 0 0 2rem 0;\n            color: #6b7280;\n            font-size: 1rem;\n          ";const i=document.createElement("button");return i.textContent="Close",i.style.cssText="\n            padding: 0.75rem 1.5rem;\n            background: #000000;\n            color: white;\n            border: none;\n            border-radius: 6px;\n            font-size: 1rem;\n            font-weight: 500;\n            cursor: pointer;\n          ",i.onclick=()=>{document.body.removeChild(p)},e.appendChild(t),e.appendChild(n),e.appendChild(i),u.appendChild(e),void this.callbacks.onFailure?.({passed:!1,score:a.attempt?.score||0})}const l=await t(this.config.companyId,e,this.config?.testMode),h=l.config?.passThreshold||70,f=void 0!==r?r:this.config?.testMode,g=await o(this.config.companyId,e,d,f);let b=[],y=0,x=[];if(g.resumed&&"in_progress"===a.status){const t=a.attempt?.questionsShown;if(Array.isArray(t)&&t.length>0)b=t,x=(a.attempt?.answers||[]).filter(e=>null!=e).map(e=>({questionId:e.questionId,answer:e.answer})),y=a.firstUnansweredIndex||0;else if(g.questions&&g.questions.length>0)b=g.questions;else{b=(await n(this.config.companyId,e,d)).questions}}else if(g.questions&&g.questions.length>0)b=g.questions;else{b=(await n(this.config.companyId,e,d)).questions}if(!Array.isArray(b)||0===b.length)return alert("No questions available"),void document.body.removeChild(p);w(u,b,h,g.sessionToken,g.attemptId,y,x,e=>{c&&c(e)},0,this.widgetStyles||void 0,this.config?.testMode)}catch(h){alert(`Error: ${h.message||"Failed to start verification"}`),document.body.removeChild(p)}},this.widgetStyles||void 0)}async showQuizModal(e,t,n,o){return new Promise(t=>{const s=document.createElement("div");s.style.cssText="\n        position: fixed;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        background: rgba(0, 0, 0, 0.5);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        z-index: 10000;\n      ";const r=document.createElement("div");r.style.cssText="\n        background: white;\n        padding: 2rem;\n        border-radius: 8px;\n        max-width: 600px;\n        width: 90%;\n        max-height: 90vh;\n        overflow-y: auto;\n      ";let a=0;const c=[],l=Date.now(),d=()=>{r.innerHTML="";const m=e[a],p=a+1,u=e.length,h=document.createElement("div");h.innerHTML=`\n          <h2 style="margin: 0 0 1rem 0;">Question ${p} of ${u}</h2>\n          <p style="margin: 0 0 1.5rem 0;">${m.prompt}</p>\n        `,r.appendChild(h);const f=document.createElement("div");if(f.style.marginBottom="1.5rem","multiple_choice"===m.type){(m.config.options||[]).forEach(e=>{const t=document.createElement("label");t.style.cssText="\n              display: block;\n              padding: 0.75rem;\n              margin: 0.5rem 0;\n              border: 1px solid #ddd;\n              border-radius: 4px;\n              cursor: pointer;\n            ";const n=document.createElement("input");n.type="radio",n.name=`question-${m.id}`,n.value=e,t.appendChild(n),t.appendChild(document.createTextNode(` ${e}`)),f.appendChild(t)})}else if("fill_blank_blocks"===m.type){const e=document.createElement("textarea");e.placeholder="Enter your answer...",e.style.cssText="\n            width: 100%;\n            min-height: 100px;\n            padding: 0.5rem;\n            border: 1px solid #ddd;\n            border-radius: 4px;\n          ",f.appendChild(e)}r.appendChild(f);const g=document.createElement("div");if(g.style.cssText="\n          display: flex;\n          justify-content: space-between;\n          margin-top: 1.5rem;\n        ",a>0){const e=document.createElement("button");e.textContent="Previous",e.onclick=()=>{a--,d()},g.appendChild(e)}else g.appendChild(document.createElement("div"));const b=document.createElement("button");b.textContent=a===e.length-1?"Submit":"Next",b.onclick=()=>{let r="";if("multiple_choice"===m.type){const e=document.querySelector(`input[name="question-${m.id}"]:checked`);r=e?.value||""}else if("fill_blank_blocks"===m.type){const e=f.querySelector("textarea");r=e?.value||""}r?(c.push({questionId:m.id,question:m,answer:r}),a<e.length-1?(a++,d()):i(n,o,c,Math.floor((Date.now()-l)/1e3)).then(e=>{document.body.removeChild(s),t({passed:e.passed,score:e.score})}).catch(e=>{alert(`Error submitting: ${e.message}`)})):alert("Please provide an answer")},g.appendChild(b),r.appendChild(g)};d(),s.appendChild(r),document.body.appendChild(s)})}async initElement(e,t){if(!this.config)throw new Error("Widget not initialized");const n=e.getAttribute("data-reqcheck-mode"),o=t||e.getAttribute("data-reqcheck-job")||this.config.jobId;o&&("protect"===n&&e instanceof HTMLFormElement?await this.attachToForm(e,o):"gate"===n?await this.attachToElement(e,o):"inline"===n&&await this.attachToInlineElement(e,o))}};if("undefined"!=typeof window){(()=>{const e=document.currentScript;if(e){const t=e.getAttribute("data-reqcheck-company"),n="false"!==e.getAttribute("data-reqcheck-auto-init"),o="true"===e.getAttribute("data-reqcheck-test-mode");t&&C.init({companyId:t,jobId:"",autoInit:n,testMode:o},{})}})(),"loading"===document.readyState&&document.addEventListener("DOMContentLoaded",()=>{C&&"function"==typeof C.rescan&&C.rescan()})}return window.ReqCheck={init:C.init.bind(C),verify:C.verify.bind(C),initElement:C.initElement.bind(C),rescan:C.rescan.bind(C)},C}();
